% arara: pdflatex
% arara: makeindex: {style: bib2gls.ist}
% arara: pdflatex
\documentclass[titlepage=false,index=totoc]{scrreprt}

\usepackage[T1]{fontenc}
\usepackage{alltt}
\usepackage{upquote}
\usepackage{etoolbox}
\usepackage{filecontents}

\newcommand*{\actual}{=}

\begin{filecontents*}{\jobname.ist}
actual '='
\end{filecontents*}

\usepackage{amsmath}
\usepackage{accents}
\usepackage{makeidx}
\usepackage{datetime2}
\usepackage[colorlinks]{hyperref}

\makeindex

\DTMsavetimestamp{creation}{2017-01-20T15:39:00Z}

\IfFileExists{../java/Bib2Gls.java}
{
  \DTMsavefilemoddate{moddate}{../java/Bib2Gls.java}
}
{
  \DTMsavenow{moddate}
}

\newif\ifmainmatter

\newcommand{\frontmatter}{%
 \clearpage\pagenumbering{roman}%
 \mainmatterfalse
}
\newcommand{\mainmatter}{%
 \clearpage\pagenumbering{arabic}%
 \mainmattertrue
}

\newcommand{\bibgls}{\appfmt{bib2gls}}

\newcommand*{\sectionref}[1]{\hyperref[#1]{section~\ref*{#1}}}
\newcommand*{\Sectionref}[1]{\hyperref[#1]{Section~\ref*{#1}}}

\newcommand{\qt}[1]{``#1''}

\newcommand{\qtt}[1]{\qt{\,\texttt{#1}\,}}

\newcommand{\dequals}{%
 \texorpdfstring
 {\discretionary{}{}{}\texttt{=}\discretionary{}{}{}}%
 {=}%
}

\newcommand{\dcomma}{%
 \texorpdfstring
 {\texttt{,}\discretionary{}{}{}}%
 {,}%
}

\newcommand{\dcolon}{%
 \texorpdfstring
 {\texttt{:}\discretionary{}{}{}}%
 {:}%
}

% put page break before dash to avoid confusion with a hyphen
\newcommand{\dhyphen}{%
 \texorpdfstring
 {\discretionary{}{}{}\texttt{-}}%
 {-}%
}

\newcommand*{\filefmt}[1]{\texorpdfstring{\nolinkurl{#1}}{#1}}
\newcommand*{\metafilefmt}[3]{%
  \filefmt{#1}\discretionary{}{}{}\meta{#2}\discretionary{}{}{}\filefmt{#3}%
}

\newcommand*{\appfmt}[1]{\texorpdfstring{\texttt{#1}}{#1}}
\newcommand*{\styfmt}[1]{\texorpdfstring{\textsf{#1}}{#1}}
\newcommand*{\csfmt}[1]{\texorpdfstring{\texttt{\char`\\ #1}}{\string\\#1}}
\newcommand*{\optfmt}[1]{\texorpdfstring{\texttt{#1}}{#1}}
\newcommand*{\fieldfmt}[1]{\texorpdfstring{\texttt{#1}}{#1}}
\newcommand*{\entryfmt}[1]{\texorpdfstring{\texttt{#1}}{#1}}
\newcommand*{\abbrstylefmt}[1]{\texorpdfstring{\textsf{#1}}{#1}}
\newcommand*{\catattrfmt}[1]{\texorpdfstring{\textsf{#1}}{#1}}
\newcommand*{\idprefixfmt}[1]{%
 \texorpdfstring{\texttt{#1\spacefactor999 .}}{#1.}}

\newcommand*{\argor}{\texorpdfstring{\protect\textbar}{\string\|}}

\newrobustcmd*{\texmeta}[1]{$\langle${\normalfont\emph{#1}}$\rangle$}

\newcommand*{\meta}[1]{%
 \texorpdfstring{\texmeta{#1}}{#1}%
}

\newcommand*{\oarg}[1]{[#1]}
\newcommand*{\oargm}[1]{\oarg{\meta{#1}}}

\newcommand*{\marg}[1]{\texorpdfstring
 {\char`\{#1\char`\} }%
 {\{#1\}}%
}

\newcommand*{\margm}[1]{\marg{\meta{#1}}}

\newcommand*{\file}[1]{%
 \texorpdfstring
 {\filefmt{#1}\index{#1\actual\filefmt{#1}}}%
 {#1}%
}

\newcommand*{\ext}[1]{%
 \texorpdfstring
 {\filefmt{.#1}\index{file formats!#1\actual\filefmt{.#1}}}%
 {.#1}%
}

\newcommand*{\app}[1]{%
 \texorpdfstring
 {\appfmt{#1}\index{#1\actual\appfmt{#1}}}%
 {#1}%
}

\newcommand*{\sty}[1]{%
  \texorpdfstring
  {\styfmt{#1}\index{#1\actual\styfmt{#1}}}%
  {#1}%
}

\newcommand*{\abbrstyle}[1]{%
  \texorpdfstring
  {\abbrstylefmt{#1}\index{abbreviation style!#1\actual\abbrstylefmt{#1}}}%
  {#1}%
}

\newcommand*{\idprefix}[1]{%
 \texorpdfstring
 {\idprefixfmt{#1}\index{label prefixes!#1\actual\protect\idprefixfmt{#1}}}%
 {#1}%
}

\newcommand*{\cs}[1]{% 
 \texorpdfstring
 {\csfmt{#1}\index{#1\actual\protect\csfmt{#1}}}
 {\string\\#1}%
}

\newcommand*{\styopt}[2][]{%
  \texorpdfstring%
  {%
    \optfmt{#2\ifblank{#1}{}{\dequals\marg{#1}}}%
    \index{package options\actual\protect\optfmt{#2}}%
    \index{#2\actual\protect\optfmt{#2}}%
  }%
  {#2\ifblank{#1}{}{=#1}}%
}

\newcommand*{\csopt}[2][]{\gencsopt[#1]{glsxtrresourcefile}{#2}}%

\newcommand*{\csoptnv}[1]{%
 \texorpdfstring
  {\protect\gencsopt{glsxtrresourcefile}{#1}}%
  {#1}%
}%

\newcommand*{\gencsopt}[3][]{%
  \texorpdfstring%
  {%
    \optfmt{#3\ifblank{#1}{}{\dequals\marg{#1}}}%
    \ifmainmatter
      \index{#2\actual\protect\csfmt{#2}!#3\actual\protect\optfmt{#3}}%
    \fi
  }%
  {#3\ifblank{#1}{}{=#1}}%
}

\newcommand*{\field}[1]{%
 \texorpdfstring
 {\fieldfmt{#1}%
   \index{fields!#1\actual\protect\fieldfmt{#1}}%
   \index{#1 field\actual\protect\fieldfmt{#1} field}%
 }%
 {#1}%
}

\newcommand*{\entry}[1]{%
 \texorpdfstring
 {\entryfmt{#1}%
   \index{entry types!#1\actual\protect\entryfmt{#1}}%
   \index{#1 entry type\actual\protect\entryfmt{#1} entry type (\protect\entryfmt{@#1})}%
 }%
 {#1}%
}

\newcommand*{\atentry}[1]{%
 \texorpdfstring
 {\entryfmt{@#1}%
   \index{entry types!#1\actual\protect\entryfmt{#1}}%
   \index{#1 entry type\actual\protect\entryfmt{#1} entry type (\protect\entryfmt{@#1})}%
 }%
 {@#1}%
}

\newrobustcmd{\longswitch}{\string-{}\string-}

\newcommand*{\longargfmt}[1]{%
 \texorpdfstring{\texttt{\longswitch #1}}%
 {\string-\string-#1}%
}

\newcommand*{\shortargfmt}[1]{%
 \texorpdfstring{\texttt{\string-#1}}%
 {\string-#1}%
}

\newcommand*{\longarg}[1]{%
  \texorpdfstring
  {\longargfmt{#1}\index{command line options!#1\actual\protect\longargfmt{#1}}}%
  {\string-\string-#1}%
}

\newcommand*{\shortarg}[1]{%
  \texorpdfstring
  {\shortargfmt{#1}\index{command line options!#1\actual\protect\shortargfmt{#1}}}%
  {\string-#1}%
}

\newenvironment{definition}%
 {\begin{flushleft}\ttfamily\ignorespaces}%
 {\end{flushleft}}

% This is a bit fiddly. Need to represent \vec{v} in typewriter
% font for the interpreter examples. ($\mathtt{\vec{v}}$ doesn't
% work)
\newsavebox\varrow
\sbox\varrow{$\mathtt{\accentset{\to}{v}}$}

\newcommand*{\mtx}[1]{\boldsymbol{#1}}
\newcommand*{\set}[1]{\mathcal{#1}}
\newcommand*{\card}[1]{|\set{#1}|}
\newcommand*{\imaginary}{i}

\title{\appfmt{bib2gls}: a command line application to convert
\filefmt{.bib} files to a \filefmt{glossaries-extra.sty} resource file}
\author{Nicola Talbot}
\date{\DTMusedate{moddate} (Still Under Development)}

\makeatletter
\begingroup
 \let\texorpdfstring\@secondoftwo
 \DTMsetstyle{pdf}
 \protected@edef\x{\endgroup
   \noexpand\hypersetup{%
   pdftitle={\@title},
   pdfauthor={\@author}}%
   \noexpand\pdfinfo{/CreationDate (\DTMuse{creation})
   /ModDate (\DTMuse{moddate})
   }%
 }\x

\newcommand*{\labelarg}[1]{%
 {\def\@currentlabelname{\protect\longarg{#1}}\label{arg.#1}}%
}
\newcommand*{\argref}[1]{\nameref{arg.#1}}

\newcommand*{\labelopt}[1]{%
 {\def\@currentlabelname{\protect\optfmt{#1}}\label{opt.#1}}%
}
\newcommand*{\optref}[2][]{\nameref{opt.#2}\ifblank{#1}{}{\optfmt{\dequals\marg{#1}}}}

\newcommand*{\labelatentry}[1]{%
 {\def\@currentlabelname{\protect\atentry{#1}}\label{at.#1}}%
}
\newcommand*{\atentryref}[1]{\nameref{at.#1}}

\newcommand*{\labelcs}[1]{%
 {\def\@currentlabelname{\protect\cs{#1}}\label{cs.#1}}%
}
\newcommand*{\csref}[1]{\nameref{cs.#1}}

\makeatother

\begin{document}
\maketitle
\pagenumbering{alph}
\thispagestyle{empty}

\begin{abstract}
The \bibgls\ command line application can be used to extract
glossary information stored in a \filefmt{.bib} file and convert it
into glossary entry definition commands that can be read using
\styfmt{glossaries-extra}'s \csfmt{glsxtrresourcefile} command. When used
in combination with the \optfmt{record} package option, \bibgls\
can select only those entries that have been used in the document,
as well as any dependent entries, which reduces the \TeX\ resources
required by not defining unwanted entries.

Since \bibgls\ can also sort and collate the recorded locations
present in the \filefmt{.aux} file, it can simultaneously by-pass the
need to use \appfmt{makeindex} or \appfmt{xindy}, although \bibgls\ 
can be used together with an external indexing application if required. (For
example, if a custom \appfmt{xindy} rule is needed.)

Note that \bibgls\ is a Java application, so it requires the
Java Runtime Environment (at least JRE~7). Additionally,
\styfmt{glossaries-extra} must be at least version 1.12.
This application was developed in response to the question
\href{http://tex.stackexchange.com/q/342544}{Is there a program for
managing glossary tags?} on \TeX\ on StackExchange.
\end{abstract}

\frontmatter

\tableofcontents

\mainmatter
\chapter{Introduction}

If you have extensively used the \styfmt{glossaries} or
\styfmt{glossaries-extra} package, you may have found yourself
creating a large \ext{tex} file containing many definitions that
you frequently use in documents. This file can then simply be
loaded using \cs{input} or \cs{loadglsentries}, but a large file
like this can be difficult to maintain and if the document only
actually uses a small proportion of those entries, the document
build is unnecessarily slow due to the time and resources taken on
defining the unwanted entries.

The aim of \bibgls\ is to allow the entries to be stored in a
\ext{bib} file, which can be maintained using a reference system
such as JabRef. The document build process
can now be analogous to that used with \app{bibtex} (or
\appfmt{biber}), where only those entries that have been recorded in the
document (and possibly their dependent entries) will be extracted
from the \ext{bib} file.

Note that \bibgls\ requires the extension package
\sty{glossaries-extra} and can't be used with just the base
\sty{glossaries} package, since it requires some of the extension
commands. See the \sty{glossaries-extra} user manual for information
on the differences between the basic package and the extended
package, as some of the default settings are different.

\section{Example Use}
The glossary entries are stored in a \ext{bib} file. For
example, the file \filefmt{entries.bib} might contain:
\begin{verbatim}
@entry{bird,
  name={bird},
  description = {feathered animal}
}

@abbreviation{html,
  short="html",
  long={hypertext markup language}
}

@symbol{v,
  name={$\vec{v}$},
  text={\vec{v}},
  description={a vector}
}

@index{goose,plural="geese"}
\end{verbatim}
Here's an example document that uses this data:
\begin{verbatim}
\documentclass{article}

\usepackage[record]{glossaries-extra}

\GlsXtrLoadResources[
  src={entries},% data in entries.bib
  sort={en-GB},% sort according to 'en-GB' locale
]

\begin{document}
\Gls{bird} and \gls{goose}.

\printunsrtglossaries
\end{document}
\end{verbatim}
If this document is called \filefmt{myDoc.tex}, the build 
process is:
\begin{verbatim}
pdflatex myDoc
bib2gls myDoc
pdflatex myDoc
\end{verbatim}

Note that there's no need to called \app{xindy} or \app{makeindex}
since \bibgls\ automatically sorts and collates the locations
after selecting the required entries from the \ext{bib} file and
before writing the temporary file that's input with \cs{GlsXtrLoadResources}
(or \cs{glsxtrresourcefile}).
This means the entries are already defined in the correct order,
and only those entries that have been used in the document are
defined,
so \cs{printunsrtglossary} (or \cs{printunsrtglossaries}) may
be used.  (The \texttt{unsrt} part
of the command name indicates that all defined entries should be listed in the
order of definition from \sty{glossaries-extra}'s point of view.)

If you additionally want to use an indexing application, such
as \app{xindy}, you need the package option
\styopt[alsoindex]{record} and use \cs{makeglossaries}
and \cs{printglossary} (or \cs{printglossaries}) as usual.


\section{Security}

\TeX\ distributions come with two security settings
\texttt{openin\_any} and \texttt{openout\_any} that, respectively,
govern read and write file access (in addition to the operating
system's file permissions). \bibgls\ uses \app{kpsewhich} to
determine these values and honours them.

\section{Localisation}
\label{sec:lang.xml}

The messages produced by \bibgls\ are fetched from a resource file
called \metafilefmt{bib2gls-}{lang}{.xml}, where \meta{lang} is a
valid IETF language tag.

The appropriate file is searched for in the following order:
\begin{enumerate}
\item \meta{lang} exactly matches the operating system's locale.
For example, my locale is \texttt{en-GB}, so \bibgls\ will first search
for \filefmt{bib2gls-en-GB.xml}. This file doesn't exist, so it will
try again.

\item If the operating system's locale has an associated script, the
next try is with \meta{lang} set to \meta{lang
code}\texttt{-}\meta{script} where \meta{lang code} is the two
letter ISO language code and \meta{script} is the script code.
For example, if the operating system's locale is \texttt{sr-RS-Latn}
then \bibgls\ will search for \filefmt{bib2gls-sr-Latn.xml} if
\filefmt{bib2gls-sr-RS-Latn.xml} doesn't exist.

\item The final attempt is with \meta{lang} set to just the two
letter ISO language code. For example, \filefmt{bib2gls-en-GB.xml}.
\end{enumerate}

If there is no match, \bibgls\ will fallback on the English resource file
\file{bib2gls-en.xml}.

Note that if you use the \optref[true]{loc-prefix} option, the
textual labels (\qt{Page} and \qt{Pages} in English) will be taken
from the resource file. In the event that the loaded resource file
doesn't match the document language, you will have to manually set
the correct translation (in English, this would be
\optfmt{loc-prefix\dequals\marg{Page,Pages}}).

Currently only \file{bib2gls-en.xml} exists as my language skills aren't up
to translating it. Any volunteers who want to provide other language
resource files would be much appreciated.

\section{Manual Installation}

If you are unable to install \bibgls\ through your \TeX\ package
manager, you can install manually using the instructions below.
Replace \meta{TEXMF} with the path to your local or home TEXMF tree 
(for example, \filefmt{~/texmf}).

Copy the files provided to the following locations:
\begin{itemize}
\item \meta{TEXMF}\filefmt{/scripts/bib2gls/bib2gls.jar}
\item \meta{TEXMF}\filefmt{/scripts/bib2gls/texparserlib.jar}
\item \meta{TEXMF}\filefmt{/scripts/bib2gls/resources/bib2gls-en.xml}
\item \meta{TEXMF}\filefmt{/doc/support/bib2gls/bib2gls.pdf}
\end{itemize}

If you are using a Unix-like system, there's also a bash script
provided called \file{bib2gls.sh}. Either copy it directly to
somewhere on your path without the \ext{sh} extension. For
example:
\begin{verbatim}
cp bib2gls.sh ~/bin/bib2gls
\end{verbatim}
or copy the file to
\meta{TEXMF}\filefmt{/scripts/bib2gls/bib2gls.sh} and create a
symbolic link to it called just \filefmt{bib2gls} from somewhere on
your path. For example:
\begin{verbatim}
cp bib2gls.sh ~/texmf/scripts/bib2gls/
cd ~/bin
ln -s ~/texmf/scripts/bib2gls/bib2gls.sh
\end{verbatim}

Windows users can create a \ext{bat} file that works in a
similar way to the bash script. To do this, create a file called
\file{bib2gls.bat} that contains the following:
\begin{verbatim}
@ECHO OFF
FOR /F %%I IN ('kpsewhich --progname=bib2gls --format=texmfscripts
bib2gls.jar') DO SET JARPATH=%%I
java -Djava.locale.providers=CLDR,JRE -jar "%JARPATH%" %*
\end{verbatim}
Save this file to somewhere on your system's path.

You may need to refresh \TeX's database to ensure that
\app{kpsewhich} can find the \ext{jar} file.

To test that the application has been successfully installed, open a
command prompt or terminal and run the following command:
\begin{verbatim}
bib2gls --version
\end{verbatim}
This should display the version information.

\chapter{\texorpdfstring{\TeX}{TeX}\ Parser Library}
\label{sec:texparserlib}

The \bibgls\ application requires the \TeX\ Parser Library
\file{texparserlib.jar}\footnote{\url{https://github.com/nlct/texparser}} which is used to parse the \ext{aux}
and \ext{bib} files.

With the \argref{interpret} switch on (default), this library is
also used to interpret the value of the fallback field
used when the \field{sort} field is missing (when the \optref{sort}
option is not
\optfmt{unsrt} or \optfmt{none} or \optfmt{use}). The other case is with
\optref{set-widest} when determining the width of the \field{name}
field. The \argref{no-interpret} switch will turn off this
function, but the library will still be used to parse the \ext{aux}
and \ext{bib} files. If your \field{name} fields only contain
simple text with no \TeX\ markup, \bibgls\ will run faster
with \argref{no-interpret}.

The \file{texparserlib.jar} library is not intended as a full-blown
\TeX\ engine and there are plenty of situations where it doesn't
work. In particular, in this case it's being used in a fragmented context without
knowing the packages used by the document or any custom commands or
environments provided within the document.

\TeX\ syntax can be quite complicated and in some cases far too
complicated for simple regular expressions. The library performs
better than a simple pattern match, and that's the purpose of
\file{texparserlib.jar} and why it's used by \bibgls. When
the \argref{debug} mode is on, any warnings or errors triggered by
the \argref{interpret} mode will be written to the transcript
prefixed with \texttt{texparserlib:} (the results of the conversions
will be included in the transcript as informational messages
prefixed with \texttt{texparserlib:} even with \argref{no-debug}).

For example, suppose the \ext{bib} file includes:
\begin{verbatim}
@preamble{
"\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}"}

@symbol{M,
  name={{}$\mtx{M}$},
  text={\mtx{M}},
  description={a matrix}
}

@symbol{v,
  name={{}$\vec{v}$},
  text={\vec{v}},
  description={a vector}
}

@symbol{S,
  name={{}$\set{S}$},
  text={\set{S}},
  description={a set}
}

@symbol{card,
  name={{}$\card{S}$},
  text={\card{S}},
  description={the cardinality of the set $\set{S}$}
}

@symbol{i,
  name={{}$\imaginary$},
  text={\imaginary},
  description={square root of minus one ($\sqrt{-1}$)}
}
\end{verbatim}
(The empty group at the start of the \field{name} fields
protects against the possibility that the \catattrfmt{glossname}
category attribute might be set to \optfmt{firstuc}, which
automatically converts the first letter of the name to 
upper case when displaying the glossary.)

None of these entries have a \field{sort} field.
With \argref{no-interpret} the \atentryref{symbol} entry type
will fallback on the entry's label when the \field{sort} field
is missing. With \argref{interpret} the \field{name} field
will be used as the fallback (or the \field{parent} if 
\field{name} is missing).

This means that with \argref{no-interpret}, and the default
\optref[sort]{sort-field}, and with
\optref[letter-case]{sort}, these entries will be defined in
the order: \texttt{M}, \texttt{S}, \texttt{card}, \texttt{i}, \texttt{v} (since
this is the case-sensitive letter order of the labels) whereas
with \optref[letter-nocase]{sort-field}, the order will be:
\texttt{card}, \texttt{i}, \texttt{M}, \texttt{S}, \texttt{v} (since this
is the case-insensitive letter order of the labels).

However, with \argref{interpret} on, the fallback field will
be taken from the \field{name} which in the above example contains \TeX\ code, so
\bibgls\ will use \file{texparserlib.jar} to interpret this code.
The library has several different ways of writing the processed
code. For simplicity, \bibgls\ uses the library's HTML output and then 
strips the HTML markup and trims any leading or trailing
spaces. The library method that writes non-ASCII
characters using \qtt{\&x\meta{hex};} markup is overridden
by \bibgls\ to just write the Unicode character, which means
that the letter-based sorting options will sort according
to the integer value \meta{hex} rather than the string
\qtt{\&x\meta{hex};}.

In the case of the \texttt{M} entry in the example above, the 
code that's passed to the interpreter is:
\begin{verbatim}
\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}
{}$\mtx{M}$
\end{verbatim}
The transcript (\ext{glg}) file will show the results of the
conversion:\footnote{The \argref{debug} mode will show additional
information.}
\begin{verbatim}
texparserlib: {}$\mtx{M}$ -> M
\end{verbatim}
So the \field{sort} value for this entry is set to \qtt{M}. The font
change (caused by math-mode and \cs{boldsymbol}) has been 
ignored. The sort value therefore consists of a single Unicode
character 0x4D (Latin upper case letter \qtt{M}, decimal value 77).

For the \texttt{v} entry, the code is:
\begin{verbatim}
\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}
{}$\vec{v}$
\end{verbatim}
The transcript shows:
\begin{alltt}
texparserlib: \marg{}\$\csfmt{vec}\marg{v}\$ -> \usebox\varrow
\end{alltt}
So the \field{sort} value for this entry is set to \qtt{\usebox\varrow},
which consists of two Unicode characters 0x76
(Latin lower case letter \qtt{v}, decimal value 118) and 
0x20D7 (combining right arrow above, decimal value 8407).

For the \texttt{set} entry, the code is:
\begin{verbatim}
\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}
{}$\set{S}$
\end{verbatim}
The transcript shows:
\begin{verbatim}
texparserlib: {}$\set{S}$ -> S
\end{verbatim}
So the \field{sort} value for this entry is set to \qtt{S} (again
ignoring the font change). This consists of a single Unicode
character 0x53 (Latin upper case letter \qtt{S}, decimal value~83).

For the \texttt{card} entry, the code is:
\begin{verbatim}
\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}
{}$\card{S}$
\end{verbatim}
The transcript shows:
\begin{verbatim}
texparserlib: {}$\card{S}$ -> |S|
\end{verbatim}
So the \field{sort} value for this entry is set to \qtt{|S|}
(the \textbar\ characters from the definition of \csfmt{card} provided
by the \atentry{preamble} have been included, but the
font change has been discarded). In this case the sort value
consists of three Unicode characters 0x7C (vertical line, decimal
value 124),
0x53 (Latin upper case letter \qtt{S}, decimal value 83) and 0x7C again.

For the \texttt{i} entry, the code is:
\begin{verbatim}
\providecommand{\mtx}[1]{\boldsymbol{#1}}
\providecommand{\set}[1]{\mathcal{#1}}
\providecommand{\card}[1]{|\set{#1}|}
\providecommand{\imaginary}{i}
{}$\imaginary$
\end{verbatim}
The transcript shows:
\begin{verbatim}
texparserlib: {}$\imaginary$ -> i
\end{verbatim}
So the \field{sort} value for this entry is set to \qtt{i}

This means that in the case of the default \optref[sort]{sort-field} with
\optref[letter-case]{sort}, these entries will be defined in
the order: \texttt{M} ($\mtx{M}$), \texttt{S} ($\set{S}$),
\texttt{i} ($\imaginary$), \texttt{v} ($\vec{v}$) and
\texttt{card} ($\card{S}$).
In this case, the entries have been sorted according to
the character codes. If you run \bibgls\ with \argref{verbose}
the decimal character codes will be included in the transcript.
For this example:
\begin{alltt}
i -> 'i' [105]
card -> '|S|' [124 83 124]
M -> 'M' [77]
S -> 'S' [83]
v -> '\usebox\varrow' [118 8407]
\end{alltt}

The \argref{group} option (in addition to \argref{verbose}) 
will place the letter group in 
parentheses before the character code list:
\begin{alltt}
i -> 'i' (i) [105]
card -> '|S|' [124 83 124]
M -> 'M' (M) [77]
S -> 'S' (S) [83]
v -> '\usebox\varrow' (v) [118 8407]
\end{alltt}
(Note that the \texttt{card} entry doesn't have a letter
group since the vertical bar character isn't considered a 
letter.)


If \optref[letter-nocase]{sort} is used instead, after conversion
by the interpreter, the sort values will all be converted to
lower case. The order is now: \texttt{i} ($\imaginary$), 
\texttt{M} ($\mtx{M}$), \texttt{S} ($\set{S}$),
\texttt{v} ($\vec{v}$) and \texttt{card} ($\card{S}$).
The transcript (with \argref{verbose}) now shows
\begin{alltt}
i -> 'i' [105]
card -> '|s|' [124 115 124]
M -> 'm' [109]
S -> 's' [115]
v -> '\usebox\varrow' [118 8407]
\end{alltt}
With \argref{group} (in addition to \argref{verbose}) 
the letter groups are again included:
\begin{alltt}
i -> 'i' (I) [105]
card -> '|s|' [124 115 124]
M -> 'm' (M) [109]
S -> 's' (S) [115]
v -> '\usebox\varrow' (V) [118 8407]
\end{alltt}
Note that the letter groups are upper case not lower case.
Again the \texttt{card} entry doesn't have an associated
letter group.

If a locale-based sort is used, the ordering will follow the
locale's alphabet rules. For example, with \optref[en]{sort}
(English, no region or variant), the order becomes:
\texttt{card} ($\card{S}$), \texttt{i} ($\imaginary$), 
\texttt{M} ($\mtx{M}$), \texttt{S} ($\set{S}$) and
\texttt{v} ($\vec{v}$). The transcript (with \argref{verbose}) 
shows the collation keys instead:
\begin{alltt}
i -> 'i' [0 92 0 0 0 0]
card -> '|S|' [0 66 0 102 0 66 0 0 0 0]
M -> 'M' [0 96 0 0 0 0]
S -> 'S' [0 102 0 0 0 0]
v -> '\usebox\varrow' [0 105 0 0 0 0]
\end{alltt}
Again the addition of the \argref{group} switch will show
the letter groups.\footnote{For more information on collation keys see the
\href{http://docs.oracle.com/javase/8/docs/api/java/text/CollationKey.html}{CollationKey}
class in Java's API.}

Suppose I add a new symbol to my \ext{bib} file:
\begin{verbatim}
@symbol{angstrom,
  name={\AA},
  description={\AA ngstr\"om}
}
\end{verbatim}
and I also use this entry in the document. Then with
\optref[en]{sort}, the order is: \texttt{card} ($\card{S}$),
\texttt{angstrom} (\AA), \texttt{i} ($\imaginary$), \texttt{M}
($\mtx{M}$), \texttt{S} ($\set{S}$), and \texttt{v} ($\vec{v}$).
The \argref{group} switch shows that the \texttt{angstrom} entry
(\AA) has been placed in the \qt{A} letter group.

However, if I change the locale to \optref[sv]{sort}, the
\texttt{angstrom} entry is moved to the end of the list and the
\argref{group} switch shows that it's been placed in the \qt{\AA}
letter group.

If you are using Java~8, you can set the
\texttt{java.locale.providers} property to \texttt{CLDR,JRE} to use
the Common Locale Data Repository, which has more extensive
support for locales than the native Java Runtime Environment.
This isn't available for Java~7, and should be enabled by default
for the proposed Java~9.

\chapter{Command Line Options}
\label{sec:switches}

\edef\resetsecnumdepth{\noexpand\setcounter{secnumdepth}{\arabic{secnumdepth}}}
\setcounter{secnumdepth}{0}

The syntax of \bibgls\ is:
\begin{alltt}
bib2gls \oargm{options} \meta{filename}
\end{alltt}
where \meta{filename} is the name of the \ext{aux} file. (The
extension may be omitted.) Only one \meta{filename} is permitted.

Available options are listed below.

\section{\longarg{help} (or \shortarg{h})}
\labelarg{help}

Display the help message and quit.

\section{\longarg{version} (or \shortarg{v})}
\labelarg{version}

Display the version information and quit.

\section{\longarg{debug} \oargm{n}}
\labelarg{debug}

Switch on debugging mode. If \meta{n} is present, it must be a
non-negative integer indicating the debugging level. If omitted 1 is
assumed. This option also switches on the verbose mode. A value of 0
is equivalent to \longargfmt{no-debug}.

Note that multiple instances of this switch in a single invocation
can cause some confusion as \bibgls\ performs a quick parse of the
arguments for the first instance of \longarg{debug} or
\longarg{nodebug} or \longarg{silent} before the language resource
file is loaded. Any subsequent use of the switch will be picked up
on the full parse after the language resource file has been loaded.

\section{\longarg{no-debug} (or \longarg{nodebug})}
\labelarg{no-debug}

Switches off the debugging mode.

\section{\longarg{verbose}}
\labelarg{verbose}

Switches on the verbose mode. This writes extra information to the
terminal and transcript file.

\section{\longarg{no-verbose} (or \longarg{noverbose})}
\labelarg{no-verbose}

Switches off the verbose mode. This is the default behaviour.
Some messages are written to the terminal. To completely suppress
all messages (except errors), switch on the silent mode.
For additional information messages, switch on the verbose mode.

\section{\longarg{silent}}
\labelarg{silent}

Suppresses all messages except for errors that would normally be
written to the terminal. Warnings and informational messages are
written to the transcript file, which can be inspected afterwards.

\section{\longarg{log-file} \meta{filename} (or \shortarg{t}
\meta{filename})}
\labelarg{log-file}

Sets the name of the transcript file. By default, the name is the
same as the \ext{aux} file but with a \ext{glg} extension. Note that
if you use \bibgls\ in combination with \app{xindy} or
\app{makeindex}, you will need to change the transcript file name to
prevent interference.

\section{\longarg{dir} \meta{dirname} (or \shortarg{d}
\meta{dirname})}
\labelarg{dir}

By default \bibgls\ assumes that the output files should be written
in the current working directory. The input \ext{bib} files are assumed to be
either in the current working directory or on \TeX's path (in which
case \app{kpsewhich} will be used to find them).

If your \ext{aux} file isn't in the current working directory (for
example, you have run \TeX\ with \shortargfmt{output-directory})
then you need to take care how you invoke \bibgls.

Suppose I have a file called \filefmt{test-entries.bib} that
contains my entry definitions and a document called
\filefmt{mydoc.tex} that selects the \ext{bib} file using:
\begin{verbatim}
\GlsXtrLoadResources[src={test-entries}]
\end{verbatim}
If I compile this document using
\begin{verbatim}
pdflatex -output-directory tmp mydoc
\end{verbatim}
then the auxiliary file \filefmt{mydoc.aux} will be written to the
\filefmt{tmp} sub-directory. The resource information is listed in
the \ext{aux} file as
\begin{verbatim}
\glsxtr@resource{src={test-entries}}{mydoc}
\end{verbatim}
If I run \bibgls\ from the \filefmt{tmp} directory, then it won't
be able to find the \filefmt{test-entries.bib} file.

If I run \bibgls\ from the same directory as \filefmt{mydoc.tex}
using
\begin{verbatim}
bib2gls tmp/mydoc
\end{verbatim}
then the \ext{aux} file is found and the transcript file is
\filefmt{tmp/mydoc.glg} (since the default is the same as the
\ext{aux} file but with the extension changed to \ext{glg}) but the
output file \filefmt{mydoc.glstex} will be written to the current
directory.

This works fine from \TeX's point of view. The
\ext{glstex} file can be picked up by \cs{GlsXtrLoadResources} but
it may be that you'd rather the \ext{glstex} file was tidied away
into the \filefmt{tmp} directory along with all the other files.
In this case you need to invoke \bibgls\ with the \longarg{dir} or
\shortarg{d} option:
\begin{verbatim}
bib2gls -d tmp mydoc
\end{verbatim}

\section{\longarg{interpret}}
\labelarg{interpret}

Switch on the interpreter mode (default). See \sectionref{sec:texparserlib}
for more details.

\section{\longarg{no-interpret}}
\labelarg{no-interpret}

Switch off the interpreter mode. See \sectionref{sec:texparserlib}
for more details.

\section{\longarg{mfirstuc-protection} (or \shortarg{u})}
\labelarg{mfirstuc-protection}

Commands like \cs{Gls} use \cs{makefirstuc} provided by the
\sty{mfirstuc} package. This command has limitations and one of the
things that can break it is the use of a referencing command 
at the start of its argument. The \sty{glossaries-extra} package has
more detail about the problem in the \qt{Nested Links} section of
the user manual. If a glossary field starts with one of these
problematic commands, the recommended method (if the command can't
be replaced) is to insert an empty group in front of it.

For example, the following definition
\begin{verbatim}
\newabbreviation{shtml}{shtml}{\glsps{ssi} enabled \glsps{short}{html}}
\end{verbatim}
will cause a problem for \verb|\Gls{shtml}| on first use.

The above example, would be written in a \ext{bib} file as:
\begin{verbatim}
@abbreviation{shtml,
  short={shtml},
  long={\glsps{ssi} enabled \glsps{html}}
}
\end{verbatim}

With the \longarg{mfirstuc-protection} switch on (the default
behaviour), \bibgls\ will automatically insert an empty group at the
start of the \field{long} field to guard against this problem. A
warning will be written to the transcript.

\section{\longarg{no-mfirstuc-protection}}
\labelarg{no-mfirstuc-protection}

Switches off the \sty{mfirstuc} protection mechanism described
above.

\section{\longarg{mfirstuc-math-protection}}
\labelarg{mfirstuc-math-protection}

This works in the same way as \argref{mfirstuc-protection} but
guards against fields starting with inline maths
(\verb|$|\ldots\verb|$|). For example, if the \field{name} field
starts with \verb|$x$| and the glossary style automatically tries to
convert the first letter of the name to upper case, then this will
cause a problem.

With \longarg{mfirstuc-math-protection} set, \bibgls\ will
automatically insert an empty group at the start of the field and
write a warning in the transcript. This setting is on by default.

\section{\longarg{no-mfirstuc-math-protection}}
\labelarg{no-mfirstuc-math-protection}

Switches off the above.

\section{\longarg{nested-link-check} \meta{list}\argor\texttt{none}}
\labelarg{nested-link-check}

By default, \bibgls\ will parse certain fields for potential nested links.
(See the section \qt{Nested Links} in the \sty{glossaries-extra}
user manual.)

The default set of fields to check are: \field{name}, \field{text},
\field{plural}, \field{first}, \field{firstplural}, \field{long},
\field{longplural}, \field{short}, \field{shortplural} and
\field{symbol}.

You can change this set of fields using
\longarg{nested-link-check} \meta{value} where \meta{value} may be
\optfmt{none} (don't parse any of the fields) or a comma-separated
list of fields to be checked.

\section{\longarg{no-nested-link-check}}
\labelarg{no-nested-link-check}

Equivalent to \longarg{nested-link-check} \optfmt{none}.

\section{\longarg{shortcuts} \meta{value}}
\labelarg{shortcuts}

Some entries may reference another entry within a field, using
commands like \cs{gls}, so \bibgls\ parses the fields for these
commands to determine dependent entries to allow them to be selected
even if they haven't been used within the document.

The \styopt{shortcuts} package option provided by
\styfmt{glossaries-extra} defines various synonyms, such as \cs{ac}
which is equivalent to \cs{gls}. By default the value of the
\styopt{shortcuts} option will be picked up by \bibgls\ when parsing the
\ext{aux} file. This then allows \bibgls\ to additionally search for
those shortcut commands while parsing the fields.

You can override the \styopt{shortcuts} setting using
\longarg{shortcuts} \meta{value} (where \meta{value} may take
any of the allowed values for the \styopt{shortcuts} package option), 
but in general there is little need to use this switch.

\section{\longarg{map-format} \meta{format1}:\meta{format2}
or \shortarg{m} \meta{format1}:\meta{format2}}
\labelarg{map-format}

This sets up the rule of precedence for partial location
matches (see \sectionref{sec:locationopts}). For example, 
\begin{verbatim}
bib2gls --map-format "emph:hyperbf" mydoc
\end{verbatim}
This essentially means that if there's a record conflict
involving \texttt{emph}, try replacing \texttt{emph} with
\texttt{hyperbf} and see if that resolves the conflict.

If you have multiple mappings, you can either use a single
\longarg{map-format} with a comma separated list of
\meta{format1}\dcolon\meta{format2} or you can have multiple instances of 
\longarg{map-format} \meta{format1}\dcolon\meta{format2}.

Note that the mapping tests are applied as the records are
read. For example, suppose the records are listed in the \ext{aux}
file as:
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{emph}{3}
\glsxtr@record{gls.sample}{}{page}{hypersf}{3}
\glsxtr@record{gls.sample}{}{page}{hyperbf}{3}
\end{verbatim}
and \bibgls\ is invoked with
\begin{verbatim}
bib2gls --map-format "emph:hyperbf,hypersf:hyperit" mydoc
\end{verbatim}
or
\begin{verbatim}
bib2gls --map-format emph:hyperbf --map-format hypersf:hyperit mydoc
\end{verbatim}
then \bibgls\ will process these records as follows:
\begin{enumerate}
\item Accept the first record (\texttt{emph}) since there's
currently no conflict. (This is the first record for page~3 for the
entry given by \texttt{gls.sample}.)
\item The second record (\texttt{hypersf}) conflicts 
with the existing record (\texttt{emph}). Neither has
the format \texttt{glsnumberformat} so \bibgls\ consults
the mappings provided by \longargfmt{map-format}.
\begin{itemize}
\item The \texttt{hypersf} format (from the new record) is mapped to \texttt{hyperit},
so \bibgls\ checks if the existing record
has this format. In this case it doesn't (the format is
\texttt{emph}). So \bibgls\ moves onto the next test:

\item The \texttt{emph} format (from the existing record) is mapped to \texttt{hyperbf},
so \bibgls\ checks if the new record has this format.
In this case it doesn't (the format is \texttt{hypersf}).

Since the provided mappings haven't resolved this conflict,
the new record is discarded with a warning. Note that there's 
no look ahead to the next record. (There may be other 
records for other entries also used on page~3 interspersed between these records.)
\end{itemize}
\item The third record (\texttt{hyperbf}) conflicts 
with the existing record (\texttt{emph}). Neither has
the format \texttt{glsnumberformat} so \bibgls\ again consults
the mappings provided by \longargfmt{map-format}.
\begin{itemize}
\item  The new record's \texttt{hyperbf} format has no mapping provided,
so \bibgls\ moves onto the next test:

\item The existing record's \texttt{emph} format has a mapping
provided (\texttt{hyperbf}). This matches the new record's format,
so the new record takes precedence.

This means that the location list ends up with the \texttt{hyperbf}
location for page~3.
\end{itemize}
\end{enumerate}

If, on the other hand, the mappings are given as
\begin{verbatim}
--map-format "emph:hyperit,hypersf:hyperit,hyperbf:hyperit"
\end{verbatim}
then all the three conflicting records (\texttt{emph},
\texttt{hypersf} and \texttt{hyperbf}) will end up being replaced
by a single record with \texttt{hyperit} as the format.

Multiple conflicts will typically be rare as there's usually little
reason for more than two or three different location formats within
the same list. (For example, \texttt{glsnumberformat} as the default
and \texttt{hyperbf} or \texttt{hyperit} for a primary reference.)

\section{\longarg{group}}
\labelarg{group}

The \styopt{record} package option automatically creates a new field
called \field{group}. If the \longarg{group} switch is used,
\bibgls\ will try to determine the letter group for each entry and
add it to the \field{group} field. This value will be picked up by
\cs{printunsrtglossary} if letter group headings are required (for
example with the \optfmt{indexgroup} style). If
you're not using a glossary style that displays the group headings,
there's no need to use this switch. Note that this switch
doesn't automatically select an appropriate glossary style.

The default is \argref{no-group}.

\section{\longarg{no-group}}
\labelarg{no-group}

Don't use the \field{group} field. (Default.)

\chapter{\ext{bib} Format}
\label{sec:bib}

\bibgls\ recognises certain entry types. Any unrecognised types will
be ignored and a warning will be written to the transcript file.
Entries are defined in the usual \ext{bib} format:
\begin{alltt}
@\meta{entry-type}\marg{\meta{id},
  \meta{field-name-1} = \margm{text},
  ...
  \meta{field-name-n} = \margm{text}
}
\end{alltt}
where \meta{entry-type} is the entry type (listed below),
\meta{field-name-1} are the field names (same as the keys available
with \cs{newglossaryentry}) and \meta{id} is a unique label. The
label can't contain any spaces or commas. In general it's
best to stick with alpha-numeric labels.  The field values
may be delimited by braces \margm{text} or double-quotes
\texttt{"\meta{text}"}.

\bibgls\ allows you to insert prefixes to the labels when the data
is read through the \csopt{label-prefix} option. Remember to use
these prefixes when you reference the entries in the document, but
don't include them when you reference them in the \ext{bib} file.
There are some special prefixes that have a particular meaning to
\bibgls: \idprefix{dual} and \idprefix{ext\meta{n}} where
\meta{n} is a positive integer.  In the first case,
\idprefix{dual} references the dual element of a dual entry (see
\atentry{dualentry}). This prefix will be replaced by the value of
the \csopt{dual-prefix} option. The \idprefix{ext\meta{n}} prefix
is used to reference an entry from a different set of resources
(loaded by another \cs{glsxtrresourcefile} command). This prefix is
replaced by the corresponding element of the list supplied by
\csopt{ext-prefixes}.

In the event that you are using \argref{no-interpret} and
the \field{sort} value falls back on the label, the original
label supplied in the \ext{bib} file is used, not the prefixed
label.

Avoid non-ASCII characters in the \meta{id} if your document uses the 
\sty{inputenc} package.
You can set the character encoding in the \ext{bib} file using:
\begin{alltt}
\% Encoding: \meta{encoding-name}
\end{alltt}
where \meta{encoding-name} is the name of the character encoding.
For example:
\begin{verbatim}
% Encoding: UTF-8
\end{verbatim}
You can also set the encoding using the \optref{charset} option,
but it's simpler to include the above comment on the first line of
the \ext{bib} file. (This comment is also searched for by JabRef
to determine the encoding, so it works for both applications.) 
If you don't use either method \bibgls\ will
have to search the entire \ext{bib} file, which is inefficient and
you may end up with a mismatched encoding.

Each entry type may have required fields and optional fields. For the
optional fields, any key recognised by \cs{newglossaryentry} may be
used as a field. However, note that if you add
any custom keys in your document using \cs{glsaddkey} or \cs{glsaddstoragekey}, those
commands must be placed before the first use of
\cs{glsxtrresourcefile} (or the shortcut \cs{GlsXtrLoadResources}).
Any unrecognised fields will be ignored.

This is more convenient than using \cs{loadglsentries}, which
requires all the keys used in the file to be defined, regardless of
whether or not you actually need them in the document.

If an optional field is missing and \bibgls\ needs to access it for
some reason (for example, for sorting), \bibgls\ will try to
fallback on another value. The actual fallback value depends on the
entry type.

Other entries can be cross-referenced using the \field{see} field or
by using commands like \cs{gls} or \cs{glsxtrp} in any of the
recognised fields. These will automatically be selected if the
\csopt{selection} setting includes dependencies, but you may need to
rebuild the document to ensure the location lists are correct.

The standard \atentry{string}\labelatentry{string} and 
\atentry{preamble}\labelatentry{preamble} types are recognised, so you
can do, for example:
\begin{verbatim}
@string{ssi={server-side includes}}
@string{html={hypertext markup language}}

@abbreviation{shtml,
  short="shtml",
  long= ssi # " enabled " # html,
  see={ssi,html}
}

@abbreviation{html,
  short ="html",
  long  = html
}

@abbreviation{ssi,
  short="ssi",
  long = ssi
}

@preamble{"\providecommand{\mtx}[1]{\boldsymbol{#1}}"}

@entry{matrix,
  name={matrix},
  plural={matrices},
  description={rectangular array of values, denoted $\mtx{M}$}
}
\end{verbatim}

\section{\atentry{entry}}
\labelatentry{entry}

Regular terms are defined by the \atentry{entry} field (such as in
the \texttt{matrix} example above). This requires the
\field{description} field and either \field{name} or \field{parent}.

For example:
\begin{verbatim}
@preamble{"\providecommand{\seealsoname}{see also}
\providecommand{\mtx}[1]{\boldsymbol{#1}}"}

@entry{matrix,
  name={matrix},
  plural={matrices},
  description={rectangular array of values, denoted \gls{M}},
  see={[\seealsoname]{vector}}
}

@entry{M,
  sort={M},
  name={\ensuremath{M}},
  description={a \gls{matrix}}
}

@entry{vector,
  name = "vector",
  description = {column or row of values, denoted \gls{v}},
  see={[\seealsoname]{matrix}}
}

@entry{v,
  sort={v},
  name={\ensuremath{\vec{v}}},
  description={a \gls{vector}}
}
\end{verbatim}

If the \field{sort} field is omitted, \bibgls\ will sort according
to the \field{name} field (or the \field{parent} field if
\field{name} is missing).

Terms defined using \atentry{entry} will be written to the output
file using the command \csref{bibglsnewentry}.

\section{\atentry{symbol}}
\labelatentry{symbol}

The \entry{symbol} entry type is much like \entry{entry}, but it's
designed specifically for symbols, so in the previous example, the
\texttt{M} and \texttt{v} terms would be better defined using the
\atentry{symbol} entry type instead.

Again the required fields are \field{description} and either
\field{name} or \field{parent}. If the \field{sort} field
is omitted, the default sort is given by the entry label
when \bibgls\ is invoked with \argref{no-interpret}
and by the \field{name} or \field{parent} when
\bibgls\ is invoked with \argref{interpret}. See
\sectionref{sec:texparserlib} for further details.

Terms defined using \atentry{symbol} will be written to the output
file using the command \csref{bibglsnewsymbol}.

\section{\atentry{number}}
\labelatentry{number}

The \entry{number} entry type is like \entry{symbol}, but it's for numbers.
Terms defined using \atentry{number} will be written to the output
file using the command \csref{bibglsnewnumber}.

\section{\atentry{index}}
\labelatentry{index}

The \entry{index} entry type is designed for entries that don't have
a description. Only the label is required. If \field{name} is
omitted, it's assumed to be the same as the label. However, this
means that if the name contains any characters that can't be used in
the label, you will need the \field{name} field. If the \field{sort}
field is omitted, \bibgls\ will use the \field{name} field instead,
if present, otherwise it will use the label.

Example:
\begin{verbatim}
@index{duck}

@index{goose,plural={geese}}

@index{facade,name={fa\c{c}ade}}
\end{verbatim}

Terms defined using \atentry{index} will be written to the output
file using the command \csref{bibglsnewindex}.

\section{\atentry{abbreviation}}
\labelatentry{abbreviation}

The \entry{abbreviation} entry type is designed for abbreviations.
The required fields are \field{short} and \field{long}. If the
\field{sort} key is missing, \bibgls\ will use the value of the
\field{short} field.

Note that you must set the abbreviation style before loading the
resource file to ensure that the abbreviations are defined
correctly, however \bibgls\ has no knowledge of the abbreviation
style so it doesn't know if the \field{description} field must be
included or if the default \field{sort} value isn't simply the value
of the \field{short} field.

You can instruct \bibgls\ to use a specific field for the sort value
using \optref{sort-field} and you can also tell \bibgls\ to ignore
certain fields using the \optref{ignore-fields}, so you can
include a \field{description} field if sometimes you need it and
instruct \bibgls\ to ignore it when you don't want it.

For example:
\begin{verbatim}
@abbreviation{html,
  short ="html",
  long  = {hypertext markup language},
  description={a markup language for creating web pages}
}
\end{verbatim}
If you want the \abbrstyle{long-noshort-desc} style, then you can put
the following in your document (where the \ext{bib} file is called
\filefmt{entries-abbrv.bib}):
\begin{verbatim}
\setabbreviationstyle{long-noshort-desc}
\GlsXtrLoadResources[src={entries-abbrv.bib},sort-field={long}]
\end{verbatim}
Whereas, if you want the \abbrstyle{long-short} style, then you can
instead do:
\begin{verbatim}
\setabbreviationstyle{long-short}
\GlsXtrLoadResources[src={entries-abbrv.bib},ignore-fields={description}]
\end{verbatim}

Terms defined using \atentry{abbreviation} will be written to the output
file using the command \csref{bibglsnewabbreviation}.

\section{\atentry{acronym}}
\labelatentry{acronym}

The \entry{acronym} entry type is like \entry{abbreviation} except that
the term is written to the output file using the command
\csref{bibglsnewacronym}.

\section{\atentry{dualentry}}
\labelatentry{dualentry}

The \entry{dualentry} entry type is similar to \entry{entry} but
actually defines two entries: the primary entry and the dual entry.
The dual entry contains the same information as the primary entry
but some of the fields are swapped around. The dual entry is given
the prefix set by the \csopt{dual-prefix} option.

By default, the \field{name} and \field{description} fields and the
\field{plural} and \field{descriptionplural} fields are swapped.

For example:
\begin{verbatim}
@dualentry{child,
  name={child},
  plural={children},
  description={enfant}
}
\end{verbatim}
Is like
\begin{verbatim}
@entry{child,
  name={child},
  plural={children},
  description={enfant}
  descriptionplural={enfants}
}

@entry{dual.child,
  description={child},
  descriptionplural={children},
  name={enfant}
  plural={enfants}
}
\end{verbatim}
where \idprefix{dual} is replaced by the value of the
\csopt{dual-prefix} option. However, instead of defining the entries
with \csfmt{bibglsnewentry} both the primary and dual entries are
defined using \csref{bibglsnewdualentry}. The \field{category} 
and \field{type} fields can be set for the dual entry using the
\csopt{dual-category} and \csopt{dual-type} options.

If \csopt[combine]{dual-sort} then the dual entries will be sorted
along with the primary entries, otherwise the \csopt{dual-sort}
indicates how to sort the dual entries and the dual entries will be
appended to the end of the \ext{glstex} file. The
\csopt{dual-sort-field} determines what field to use for the sort
value if the dual entries should be sorted separately.

For example:
\begin{verbatim}
\newglossary*{english}{English}
\newglossary*{french}{French}

\GlsXtrLoadResources[
 src           = {entries-dual},% data in entries-dual.bib
 type          = {english},% put primary entries in glossary 'english'
 dual-type     = {french},% put dual entries in glossary 'french'
 category      = {dictionary},% set the primary category to 'dictionary'
 dual-category = {dictionary},% set the dual category to 'dictionary'
 sort          = {en},% sort primary entries according to language 'en'
 dual-sort     = {fr}% sort dual entries according to language 'fr'
]
\end{verbatim}

Note that there's no dual equivalent to \atentry{index}
since that entry type doesn't have required fields and
there's nothing obvious to swap with that type that would
differentiate it from a normal entry.

\section{\atentry{dualsymbol}}
\labelatentry{dualsymbol}

Not yet implemented.

\section{\atentry{dualabbreviation}}
\labelatentry{dualabbreviation}

Not yet implemented.


\chapter{Resource File Options}
\label{sec:resourceopts}
\setcounter{secnumdepth}{1}

Make sure that you load \sty{glossaries-extra} with the
\styopt{record} package option. This ensures that \bibgls\ can pick
up the required information from the \ext{aux} file. (You may omit
this option if you use \optref[all]{selection} and you don't require
the location lists.)

The \ext{glstex} resource files created by \bibgls\ are loaded in
the document using
\begin{definition}
\cs{glsxtrresourcefile}\oargm{options}\margm{filename}
\end{definition}
where \meta{filename} is the name of the resource file without the
\ext{glstex} extension. There's a shortcut command that uses
\cs{jobname} as the \meta{filename}:
\begin{definition}
\cs{GlsXtrLoadResources}\oargm{options}
\end{definition}
This is equivalent to
\begin{definition}
\cs{glsxtrresourcefile}\oargm{options}\marg{\cs{jobname}}
\end{definition}

You can have multiple \cs{glsxtrresourcefile} commands within your
document, but each \meta{filename} must be unique. For this reason, 
\cs{GlsXtrLoadResources} can only be used once, otherwise \LaTeX\
would attempt to load \cs{jobname}\ext{glstex} multiple times.
\bibgls\ checks for non-unique file names.

The optional argument \meta{options} is a comma-separated 
\meta{key}=\meta{value} list. Allowed options are listed below.
The option list applies only to that specific
\meta{filename}\ext{glstex} and are not carried over to the next
instance of \cs{glsxtrresourcefile}.

If you have multiple \ext{bib} files you can either select them all
using \optref{src} in a single \cs{glsxtrresourcefile} call, if they
all require the same settings, or you can load them separately with
different settings applied.

For example, if the files \filefmt{entries-terms.bib} and
\filefmt{entries-symbols.bib} have the same settings:
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms,entries-symbols}]
\end{verbatim}
Alternatively, if they have different settings:
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms}]
\glsxtrresourcefile[sort=use]{entries-symbols}
\end{verbatim}

\section{General Options}
\label{sec:generalopts}

\subsection{\csoptnv{charset}=\margm{encoding-name}}
\labelopt{charset}

If the character encoding hasn't been supplied in the \ext{bib} file
with the encoding comment
\begin{alltt}
\% Encoding: \meta{encoding-name}
\end{alltt}
then you can supply the correct encoding using
\csopt[encoding-name]{charset}. In general, it's better to include
the encoding in the \ext{bib} file where it can also be read by
JabRef.

\subsection{\csoptnv{set-widest}=\margm{boolean}}
\labelopt{set-widest}

The \optfmt{alttree} glossary style needs to know the widest
\field{name} (for each level, if hierarchical). This can
be set using \cs{glssetwidest} provided by the \sty{glossaries}
package, but this requires knowing which name is the widest.

The boolean option \csopt[true]{set-widest} will try to calculate
the widest names for each hierarchical level. Since it doesn't know
the fonts that will be used in the document or if there are any
non-standard commands that aren't provided in the \ext{bib} files
preamble, this option may not work. The transcript file will 
include the message
\begin{alltt}
Calculated width of '\meta{text}': \meta{number}
\end{alltt}
where \meta{text} is \bibgls's interpretation of the contents
of the \field{name} field and \meta{number} is a rough guide
to the width of \meta{text} assuming the operating system's
default serif font. The entry that has the largest \meta{number}
is the one that will be selected. This will then be implemented
using:
\begin{alltt}
\cs{glssetwidest}\oargm{level}\marg{\cs{glsentryname}\margm{id}}
\end{alltt}
where \meta{id} is the entry's label. This leaves \TeX\ to
compute the width according to the document fonts.

If \optref{type} has been set, the \cs{glssetwidest} command
will be appended to the glossary preamble for that type, otherwise
it's simply set in the \ext{glstex} file and may be overridden
later in the document if required.

\subsection{\csoptnv{secondary}=\margm{list}}
\labelopt{secondary}

It may be that you want to display a glossary multiple times
but with a different order. For example, the first time
alphabetically and the second time by category.

You can do this with the \csopt{secondary} option. The value
(which must be supplied) is a comma-separated list where each
item in the list is in the format 
\begin{definition}
\meta{sort}:\meta{field}:\meta{type}
\end{definition}
or
\begin{definition}
\meta{sort}:\meta{type}
\end{definition}
If the
\meta{field} is omitted, the value of \optref{sort-field} is used.
The value of \meta{sort} is as for \optref{sort}, but note that in this case the sort value \optfmt{unsrt} or
\optfmt{none} means to use the same ordering as the original
entries. So with \optref[de-CH-1996]{sort},
\optref[none:copies]{secondary} the \texttt{copies}
list will be ordered according to \texttt{de-CH-1996} and not
according to the order in which they were read when the \ext{bib}
file or files were parsed.

This will copy all the selected entries into the glossary labelled
\meta{type} sorted according to \meta{sort} using \meta{field} as
the sort value.

(If the glossary \meta{type} doesn't exist, it will be
defined with \cs{provideignoredglossary*}\marg{type}.)
Note that if the glossary already exists and contains entries,
the existing entries aren't re-ordered. The new entries are
simply appended to the list.

For example, suppose the \ext{bib} file contains entries like:
\begin{verbatim}
@entry{quartz,
  name={quartz},
  description={hard mineral consisting of silica},
  category={mineral}
}

@entry{cabbage,
  name={cabbage},
  description={vegetable with thick green or purple leaves},
  category={vegetable}
}

@entry{waterfowl,
  name={waterfowl},
  description={any bird that lives in or about water},
  category={animal}
}
\end{verbatim}
and the document preamble contains:
\begin{verbatim}
\GlsXtrLoadResources[src={entries},sort={en-GB},
  secondary={en-GB:category:topic}
]
\end{verbatim}
This sorts the primary entries according to the default
\optref{sort-field} and then sorts the entries according
to the \field{category} field and copies this list to
the \texttt{topic} glossary (which will be provided if not defined.)

The secondary list can be displayed with the hypertargets switched
off to prevent duplicates. The cross-references will link to the
original glossary.

For example:
\begin{verbatim}
\printunsrtglossary[title={Summary (alphabetical)}]
\printunsrtglossary[title={Summary (by topic)},target=false]
\end{verbatim}

\section{Selection Options}
\label{sec:selectionopts}

\subsection{\csoptnv{src}=\margm{list}}
\labelopt{src}

If the \csopt{src} option is omitted, the \ext{bib} file is assumed
to be \meta{filename}\ext{bib}. For example:
\begin{verbatim}
\glsxtrresourcefile{entries-symbols}
\end{verbatim}
Indicates that \bibgls\ needs to read the file
\filefmt{entries-symbols.bib} and create the file
\filefmt{entries-symbols.glstex}. If the \ext{bib} file is
different or if you have multiple \ext{bib} files, you need to use
the \csopt{src} option.

The value should be a comma-separated list of the required \ext{bib}
files. These may either be in the current working directory or in
the directory given by the \argref{dir} switch or on
\TeX's path (in which case \app{kpsewhich} will be used to find them).
The \ext{bib} extension may be omitted. Remember that if \meta{list}
contains multiple files it must be grouped to protect the comma
from the \meta{options} list.

For example
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms,entries-symbols}]
\end{verbatim}
indicates that \bibgls\ must read the files
\filefmt{entries-terms.bib} and \filefmt{entries-symbols.bib} and
create the file obtained from \cs{jobname}\ext{glstex}.

\subsection{\csoptnv{selection}=\margm{value}}
\labelopt{selection}

By default all entries that have records in the \ext{aux} file will
be selected as well as all their dependent entries. The dependent
entries that don't have corresponding records on the first \LaTeX\
run, make need an additional build to ensure their location lists
are updated.

Remember that on the first \LaTeX\ the \ext{glstex} files don't
exist. This means that the entries can't be defined. The
\styopt{record} package option additionally switches on the
\styopt[warn]{undefaction} option, which means that you'll only get
warnings rather than errors when you reference entries in the
document. This means that you can't use \cs{glsaddall} all with
\bibgls\ because the glossary lists are empty on the first run
therefore there's nothing for \cs{glsaddall} to iterate over.
Instead, if you want to add all defined entries, you need to
instruct \bibgls\ to do this with the \csopt{selection} option. The
following values are allowed:
\begin{itemize}
\item \optfmt{recorded and deps}: add all recorded entries and
their dependencies (default).
\item \optfmt{recorded no deps}: add all recorded entries but not
their dependencies. The dependencies include those referenced in the
\field{see} field, \field{parent} entries and those found referenced
with commands like \cs{gls} in the field values that are parsed by
\bibgls. With this setting, parents will be omitted unless they've
been referenced in the document through commands like \cs{gls}.
\item \optfmt{recorded and ancestors}: this is live the previous
setting but parents are added even if they haven't been referenced
in the document. The other dependent entries are omitted if they
haven't been referenced in the document.
\item \optfmt{all}: add all entries found in the \ext{bib} files
supplied in the \csopt{src} option.
\end{itemize}
The \meta{value} must be supplied.

\subsection{\csoptnv{external}=\margm{list}}
\labelopt{external}

Not yet implemented.

\subsection{\csoptnv{match}=\margm{key-val list}}
\labelopt{match}

It's possible to filter the selection by matching field values.
If \meta{key-val list} is empty no filtering will be applied, otherwise
\meta{key-val list} should be a \meta{key}=\meta{regexp} list, where
\meta{key} is the name of a field or \optfmt{id} for the entry's
label or \optfmt{entrytype} for the entry's \ext{bib} type (as in
the part after \verb|@| in the \ext{bib} file not the \field{type}
field identifying the glossary label).

The \meta{regex} part should be a regular expression conforming
to
\href{http://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html}{Java's
Pattern class}. The pattern is anchored (\texttt{oo.*} matches
\texttt{oops} but not \texttt{loops}) and \meta{regexp} can't be
empty. Remember that \TeX\ will expand the option list as
it writes the information to the \ext{aux} file so take
care with special characters. For example, to match a literal
period use \verb|\string\.| not \verb|\.| (backslash dot).

If the field is missing its value it is assumed to be empty for
the purposes of the pattern match even if it will be assigned a
non-empty default value when the entry is defined.

If a field is listed multiple times, the pattern for that
field is concatenated using
\begin{alltt}
(?:\meta{pattern-1})|(?:\meta{pattern-2})
\end{alltt}
where \meta{pattern-1} is the current pattern for that field
and \meta{pattern-2} is the new pattern. This means it performs a
logical OR\@. For the non-duplicate
fields the logical operator is given by \optref{match-op}.

For example:
\begin{verbatim}
match-op={and},
match={
  {category=animals},
  {topic=biology},
  {category=vegetables}
}
\end{verbatim}

This will discard any entries that don't match the condition:
\field{category} matches \verb"(?:animals)|(?:vegetables)"
(the \field{category} is either \optfmt{animals} or
\optfmt{vegetables}) AND \field{topic} is \texttt{biology}.
A message will be written to the log file for each entry
that's discarded.

Patterns for unknown fields will be ignored. If the entire
list consists of patterns for unknown fields it will be
treated as \csopt[{}]{match}. That is, no filtering will be
applied.

\subsection{\csoptnv{match-op}=\margm{value}}
\labelopt{match-op}

If the value of \optref{match} contains more than one 
\meta{key}=\meta{pattern} element, the \csopt{match-op}
determines whether to apply a logical AND or a logical OR.
The \meta{value} may be either \optfmt{and} or \optfmt{or}.
The default is \csopt[and]{match-op}.

\subsection{\csoptnv{flatten}=\margm{value}}
\labelopt{flatten}

This is a boolean option. The default value is
\csopt[false]{flatten}. 

If \csopt[true]{flatten}, the sorting will ignore hierarchy and
the \field{parent} field will be omitted when writing
the definitions to the \ext{glstex} file, but the parent entries
will still be considered a dependent ancestor from the 
\optref{selection} point of view.

Note the difference between this option and using
\csopt[parent]{ignore-fields} which will remove the dependency
(unless a dependency is established through another field).

\section{Field and Label Options}
\label{sec:labelopts}

\subsection{\csoptnv{ignore-fields}=\margm{list}}
\labelopt{ignore-fields}

The \csopt{ignore-fields} key indicates that you want \bibgls\ to
skip the fields listed in supplied the comma-separated \meta{list} of field
labels. Remember that unrecognised fields will always be skipped.

For example, suppose my \ext{bib} file contains
\begin{verbatim}
@abbreviation{html,
  short ="html",
  long  = {hypertext markup language},
  description={a markup language for creating web pages},
  see={[see also]xml}
}
\end{verbatim}
but I want to use the \abbrstyle{short-long} style and I don't want
the cross-referenced term, then I can use
\csopt[see,description]{ignore-fields}.

Note that \csopt[parent]{ignore-fields} removes the \field{parent}
before determining the dependency lists. This means that
\optref[recorded and deps]{selection} and 
\optref[recorded and ancestors]{selection} won't pick up the
label in the \field{parent} field.

If you want to maintain the dependency and ancestor relationship but
omit the \field{parent} field when writing the entries to the
\ext{glstex} file, you instead need to use \optref{flatten}.

\subsection{\csoptnv{category}=\margm{value}}
\labelopt{category}

The selected entries may all have their \field{category} field
changed before writing their definitions to the \ext{glstex} file.
The \meta{value} may be:
\begin{itemize}
\item \optfmt{same as entry}: set the
\field{category} to the entry type used to define it.
\item \optfmt{same as type}: set the \field{category} to the same
value as the \field{type} field (if that field has been provided
either in the \ext{bib} file or through the \optref{type} option).
\item A category label: the \field{category} is set to \meta{value}.
\end{itemize}
This will override any
\field{category} fields supplied in the \ext{bib} file.

For example, if the \ext{bib} file contains:
\begin{verbatim}
@entry{bird,
  name={bird},
  description = {feathered animal}
}

@index{duck}

@index{goose,plural="geese"}

@dualentry{dog,
  name={dog},
  description={chien}
}
\end{verbatim}
then if the document contains
\begin{verbatim}
\GlsXtrLoadResources[category={same as entry},src={entries}]
\end{verbatim}
this will set the \field{category} of the \texttt{bird} field to
\optfmt{entry} (since it was defined with \cs{entry}), the \field{category} of the \texttt{duck} and
\texttt{goose} entries to \optfmt{index} (since they were defined
with \atentry{index}), and the \field{category} of the \texttt{dog}
entry to \optfmt{dualentry} (since it was
defined with \atentry{dualentry}). Note that the dual entry
\texttt{dual.dog} doesn't have the category set, since that's
governed by \optref{dual-category} instead.

If, instead, the document contains
\begin{verbatim}
\GlsXtrLoadResources[category={animals},src={entries}]
\end{verbatim}
then the \field{category} of all the primary selected entries will 
be set to \optfmt{animals}. Again the dual entry \texttt{dual.dog}
doesn't have the \field{category} set.

Note that the categories may be overridden by the commands,
such as \csref{bibglsnewindex}, that are used to actually define the
entries.

For example, if the document contains
\begin{verbatim}
\newcommand{\bibglsnewdualentry}[4]{%
 \longnewglossaryentry*{#1}{name={#3},#2,category={dual}}{#4}%
}

\GlsXtrLoadResources[category={animals},src={entries}]
\end{verbatim}
then both the \texttt{dog} and \texttt{dual.dog} entries will
have their \field{category} field set to \optfmt{dual} since the
new definition of \cs{bibglsnewdualentry} has overridden
the \csopt[animals]{category} option.
\subsection{\csoptnv{type}=\margm{value}}

\labelopt{type}

The \meta{value} may be \optfmt{same as entry} or a glossary label.
This is similar to the \optref{category} option except that
it sets the \field{type} field. As with the \csopt{category} option,
\csopt[same as entry]{value} indicates that the entry
type should be used. There is no \meta{value} analogous to
\csopt[same as type]{category}.

Make sure that the glossary type has already been defined. 

Note that this setting only changes the \field{type} field for
primary entries. Use \optref{dual-type} for dual entries.

For example:
\begin{verbatim}
\usepackage[record,symbols]{glossaries-extra}

\GlsXtrLoadResources[src={entries-symbols},type=symbols]
\end{verbatim}

Remember that you can use the starred version of \cs{newglossary}
if you don't want to worry about the extensions needed by
\app{makeindex} or \app{xindy}. For example:
\begin{verbatim}
\usepackage[record,nomain]{glossaries-extra}

\newglossary*{dictionary}{Dictionary}

\GlsXtrLoadResources[src={entries-symbols},type=dictionary]
\end{verbatim}
(The \styopt{nomain} option was added to suppress the
creation of the default \texttt{main} glossary.)

Alternatively you can use \cs{newignoredglossary} if you don't
want the glossary picked up by \cs{printunsrtglossaries}.


\subsection{\csoptnv{label-prefix}=\margm{tag}}
\labelopt{label-prefix}

The \csopt{label-prefix} option prepends \meta{tag} to each
entry's label. This \meta{tag} will also be inserted in front of any
cross-references, unless they start with \idprefix{dual} or
\idprefix{ext\meta{n}} (where \meta{n} is an integer).

For example, if the \ext{bib} file contains
\begin{verbatim}
@entry{bird,
  name={bird},
  description = {feathered animal, such as a \gls{duck} or \gls {goose}}
}

@entry{waterfowl,
  name={waterfowl},
  description={Any \gls{bird} that lives in or about water},
  see={[see also]{duck,goose}}
}

@index{duck}

@index{goose,plural="geese"}
\end{verbatim}
Then if this \ext{bib} file is loaded with \csopt[gls.]{label-prefix}
it's as though the entries had been defined as:
\begin{verbatim}
@entry{gls.bird,
  name={bird},
  description = {feathered animal, such as a \gls{gls.duck} or 
\gls{gls.goose}}
}

@entry{gls.waterfowl,
  name={waterfowl},
  description={Any \gls{gls.bird} that lives in or about water},
  see={[see also]{gls.duck,gls.goose}}
}

@index{gls.duck,name={duck}}

@index{gls.goose,name={goose},plural="geese"}
\end{verbatim}

Remember to use this prefix when you reference the terms in the
document with commands like \cs{gls}.

\subsection{\csoptnv{ext-prefixes}=\margm{list}}
\labelopt{ext-prefixes}

Any cross-references in the \ext{bib} file that start with
\idprefix{ext\meta{n}} (where \meta{n} is a positive integer) will be 
substituted with the \meta{n}th tag listed in the comma-separated
\meta{list}. If there aren't that many items in the list, the
\idprefix{ext\meta{n}} will simply be removed. The default setting is
an empty list, which will strip all \idprefix{ext\meta{n}} prefixes.

For example, suppose the file \filefmt{entries-terms.bib} contains:
\begin{verbatim}
@entry{set,
  name={set},
  description={collection of values, denoted \gls{ext1.set}}
}
\end{verbatim}
and the file \filefmt{entries-symbols.bib} contains:
\begin{verbatim}
@symbol{set,
  name={\ensuremath{\mathcal{S}}},
  description={a \gls{ext1.set}}
}
\end{verbatim}

These files both contain an entry with the label \texttt{set}
but the description includes \verb|\gls{ext1.set}| which is
referencing the entry from the other file. These
two files can be loaded without conflict using:
\begin{verbatim}
\usepackage[record,symbols]{glossaries-extra}

\GlsXtrLoadResources[src={entries-terms},
 label-prefix={gls.},
 ext-prefixes={sym.}
]

\glsxtrresourcefile[src={entries-symbols},
 type=symbols,
 label-prefix={sym.},
 ext-prefixes={gls.},
]
{\jobname-sym}
\end{verbatim}

Now the \texttt{set} entry from \filefmt{entries-terms.bib}
will be defined with the label \texttt{gls.set} and the
description will be
\begin{verbatim}
collection of values, denoted \gls{sym.set}
\end{verbatim}
The \texttt{set} entry
from \filefmt{entries-symbols.bib} will be defined with the label
\texttt{sym.set} and the description will be 
\begin{verbatim}
a \gls{gls.set}
\end{verbatim}

Note that in this case the \ext{bib} files have to be loaded 
as two separate resources. They can't be combined into a 
single \optref{src} list as the labels aren't unique. 

If you want to allow the flexibility to choose between 
loading them together or separately, you'll have to give them
unique labels. For example, \filefmt{entries-terms.bib} could
contain:
\begin{verbatim}
@entry{set,
  name={set},
  description={collection of values, denoted \gls{ext1.S}}
}
\end{verbatim}
and \filefmt{entries-symbols.bib} could contain:
\begin{verbatim}
@symbol{S,
  name={\ensuremath{\mathcal{S}}},
  description={a \gls{ext1.set}}
}
\end{verbatim}
Now they can be combined with:
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms,entries-symbols}]
\end{verbatim}
which will simply strip the \idprefixfmt{ext1} prefix from the
cross-references. Alternatively:
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms,entries-symbols},
 label-prefix={gls.},
 ext-prefixes={gls.}
]
\end{verbatim}
which will insert the supplied \optref{label-prefix} at the
start of the labels in the entry definitions and will replace
the \idprefix{ext1} prefix with \idprefixfmt{gls} in the
cross-references.

\section{Location List Options}
\label{sec:locationopts}

The \styopt{record} package option automatically adds two new keys: 
\field{loclist} and \field{location}. These two fields are set by
\bibgls\ from the information supplied in the \ext{aux} file. The
\field{loclist} has the format of an \sty{etoolbox} internal list
and includes every location (except for the discarded duplicates).
Each item in the list is provided in the form
\begin{alltt}
\cs{glsseeformat}\oargm{tag}\marg{\meta{label list}}\marg{}
\end{alltt}
for the cross-reference supplied by the \field{see} field and
\begin{alltt}
\cs{glsnoidxdisplayloc}\margm{prefix}\margm{counter}\margm{format}\margm{location}
\end{alltt}
for the locations. You can iterate through the \field{loclist} value
using one of \sty{etoolbox}'s internal list loops. Remember that you
can fetch the value of the field using \cs{glsfieldfetch} provided
by the \sty{glossaries} package. The locations are always listed in
the order in which they were indexed, except for the cross-reference 
which may be placed at the start or end of the list or omitted
according to \optref{loc-prefix}.

It's therefore possible to define a custom glossary style where 
\cs{glossentry} (and \cs{subglossentry}) ignore the final argument
and instead parse the \field{loclist} field and re-order the
locations. Remember that you can also use \cs{glsnoidxloclist}
provided by \sty{glossaries}. For example:
\begin{verbatim}
\glsfieldfetch{gls.sample}{loclist}{\loclist}% fetch location list
\glsnoidxloclist{\loclist}% iterate over locations
\end{verbatim}
This uses \cs{glsnoidxloclisthandler} as the list's handler
macro, which simply displays each location separated by \cs{delimN}.
(See also
\href{http://www.dickimaw-books.com/latex/admin/html/foreachtips.shtml}{Iteration
Tips and Tricks}.)

Each location is listed in the \ext{aux} file in the form:
\begin{alltt}
\cs{glsxtr@record}\margm{label}\margm{prefix}\margm{counter}\margm{format}\margm{location}
\end{alltt}
Exact duplicates are discarded. For example, if \texttt{cat}
is indexed twice on page 1:
\begin{verbatim}
\glsxtr@record{cat}{}{page}{glsnumberformat}{1}
\glsxtr@record{cat}{}{page}{glsnumberformat}{1}
\end{verbatim}
The second record is discarded. Only the first record is added
to the location list.

Partial duplicates, where all arguments match except for
\meta{format}, may be discarded depending on the value
of \meta{format}. For example, if page~1 of the document
uses \verb|\gls{cat}| and \verb|\gls[format=hyperbf]{cat}|
then the \ext{aux} file will contain:
\begin{verbatim}
\glsxtr@record{cat}{}{page}{glsnumberformat}{1}
\glsxtr@record{cat}{}{page}{hyperbf}{1}
\end{verbatim}
This is a partial record match. In this case, \bibgls\ 
makes the following tests:
\begin{itemize}
\item If one of the formats is \texttt{glsnumberformat} (as in the
above example), that format will be skipped. So in the above
example, the second record will be added to the location list, but
not the first. (A message will only be written to the transcript if
the \longarg{debug} switch is used.)
\item If a mapping has been set with the \argref{map-format}
switch that mapping will be checked.
\item Otherwise the duplicate record will be discarded with a
warning.
\end{itemize}

The \field{location} field is used to store the formatted location
list. The code for this list is generated by \bibgls\ based on the
information provided in the \ext{aux} file, the presence of the
\field{see} field and the various settings described in this
chapter. When you display the glossary using \cs{printunsrtglossary},
if the \field{location} field is present it will be displayed
according to the glossary style (and other factors, such as whether the
\optfmt{nonumberlist} option has been used, either as a package
option or supplied in the optional argument of \cs{printunsrtglossary}).
For more information on adjusting the formatting see the
\sty{glossaries} and \sty{glossaries-extra} manual.

\subsection{\csoptnv{min-loc-range}=\margm{value}}
\labelopt{min-loc-range}

By default, three or more consecutive locations \meta{loc-1},
\meta{loc-2}, \ldots, \meta{loc-n} are compressed into
the range \texttt{\meta{loc-1}\cs{delimR} \meta{loc-n}} (where
\cs{delimR} is provided by the \sty{glossaries} package). Otherwise
the locations are separated by \cs{delimN} (again provided by
\sty{glossaries}).

You can change this with the \csopt{min-loc-range} setting where
\meta{value} is either \optfmt{none} (don't form ranges) or an
integer greater than one indicating how many consecutive locations should be
converted into a range.

\bibgls\ determines if one location
\margm{prefix-2}\margm{counter-2}\margm{format-2}\margm{location-2}
is one unit more than another location
\margm{prefix-1}\margm{counter-1}\margm{format-1}\margm{location-1} 
according to the following:
\begin{enumerate}
\item\label{itm:pre} If \meta{prefix-1} is not equal to \meta{prefix-2} or
\meta{counter-1} is not equal to \meta{counter-2} or \meta{format-1}
is not equal to \meta{format-2}, then the locations aren't
considered consecutive.
\item\label{itm:emptyloc} If either \meta{location-1} or \meta{location-2} are empty,
then the locations aren't considered consecutive.
\item\label{itm.csmatch} If both \meta{location-1} and \meta{location-2} match the
pattern
\begin{verbatim}
(.*?)(?:\\protect\s*)?(\\[a-zA-Z@]+)\s*\{([0-9a-zA-Z]+)\}
\end{verbatim}
then:
  \begin{itemize}
  \item if the control sequence matched by group 2 isn't the same for
  both locations, the locations aren't considered consecutive;
  \item if the argument of the control sequence (group 3) is the same for
  both locations, then the test is retried with \meta{location-1}
set to group 1 of the first pattern match and \meta{location-2}
set to group 1 of the second pattern match;
  \item otherwise the test is retried with \meta{location-1} set to
group 3 of the first pattern match and \meta{location-2} set to
group 3 of the second pattern match.
  \end{itemize}
\item\label{itm:decmatch} If both \meta{location-1} and \meta{location-2} match the
pattern
\begin{verbatim}
(.*?)([^0-9]?)([0-9]+)
\end{verbatim}
then:
  \begin{enumerate}
  \item\label{itm:decgrp3eq} if group 3 of both pattern matches are
equal then:
  \begin{enumerate}
   \item\label{itm:decgrp3nz} if group 3 isn't zero, the locations
aren't considered consecutive;
   \item if the separators (group 2) are different the test is
retried with \meta{location-1} set to the concatenation of the first
two groups \meta{group-1}\meta{group-2} of the first pattern match 
and \meta{location-2} set to the concatenation of the first two groups
\meta{group-1}\meta{group-2} of the second pattern
match;
   \item\label{itm:decgrp3eqsepeq} if the separators (group 2) are the same the test is
retried with \meta{location-1} set to the first
group \meta{group-1} of the first pattern match 
and \meta{location-2} set to the first group
\meta{group-1} of the second pattern match.
  \end{enumerate}
  \item If \meta{group-1} of the first pattern match (of
\meta{location-1}) doesn't equal
\meta{group-1} of the second pattern match (of \meta{location-2})
or \meta{group-2} of the first pattern match (of
\meta{location-1}) doesn't equal
\meta{group-2} of the second pattern match (of \meta{location-2})
then the locations aren't considered consecutive;
   \item\label{itm:decgrp3} If $0 < l_2 - l_1 \leq g $
where $l_2$ is \meta{group 3} of the second pattern match,
$l_1$ is \meta{group 3} of the first pattern match and
$g$ is the value of \optfmt{loc-gap} then the locations
are consecutive otherwise they're not consecutive.
  \end{enumerate}
\item\label{itm:rommatch} The next pattern matches for \meta{prefix}\meta{sep}\meta{n}
where \meta{n} is a lower case Roman numeral, which is converted to
a decimal value and the test is performed in the same way as the 
above \hyperref[itm:decmatch]{decimal test}.
\item\label{itm:Rommatch} The next pattern matches for \meta{prefix}\meta{sep}\meta{n}
where \meta{n} is an upper case Roman numeral, which is converted to
a decimal value and the test is performed
in the same way as the above \hyperref[itm:decmatch]{decimal test}.
\item\label{itm:alphmatch} The next pattern matches for \meta{prefix}\meta{sep}\meta{c}
where \meta{c} is either a lower case letter from \texttt{a} to
\texttt{z} or an upper case letter from \texttt{A} to \texttt{Z}.
The character is converted to its code point and the test is
performed in the same way as the \hyperref[itm:decmatch]{decimal pattern} above.
\item\label{itm:nomatch} If none of the above, the locations aren't considered
consecutive.
\end{enumerate} 

Examples:
\begin{enumerate}
\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{1}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{2}
\end{verbatim}
These records are consecutive. The prefix, counter and format are
identical (so the test passes step~\ref{itm:pre}), the locations match
the \hyperref[itm:decmatch]{decimal pattern} and the test in
step~\ref{itm:decgrp3} passes.

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{1}
\glsxtr@record{gls.sample}{}{page}{textbf}{2}
\end{verbatim}
These records aren't consecutive since the formats are different.

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{A.i}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{A.ii}
\end{verbatim}
These records are consecutive. The prefix, counter and format are
identical (so it passes step~\ref{itm:pre}). The locations match
the \hyperref[itm:rommatch]{lower case Roman numeral pattern}, where
\texttt{A} is considered a prefix and the dot is consider a
separator. The Roman numerals i and ii are converted to decimal and
the test is retried with the locations set to 1 and 2, respectively.
This now passes the decimal pattern test (step~\ref{itm:decgrp3}).

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{i.A}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{ii.A}
\end{verbatim}
These records aren't consecutive. They match the
\hyperref[itm:alphmatch]{alpha pattern}. The first location is
considered to consist of the prefix \texttt{i}, the separator
\texttt{.} (dot) and the number given by the character code of A. 
The second location is considered to consist of the prefix
\texttt{ii}, the separator \texttt{.} (dot) and the number 
given by the character code of A.

The test fails because the numbers are equal and the prefixes are
different.

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{1.0}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{2.0}
\end{verbatim}
These records are consecutive. They match the \hyperref[itm:decmatch]{decimal
pattern}, and then step~\ref{itm:decgrp3eq} followed by
step~\ref{itm:decgrp3eqsepeq}. The \texttt{.0} part is discarded and
the test is retried with the first location set to 1 and the second
location set to 2.

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{1.1}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{2.1}
\end{verbatim}
These records aren't consecutive as the test branches off into
step~\ref{itm:decgrp3nz}.

\item
\begin{verbatim}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{\@alph{1}}
\glsxtr@record{gls.sample}{}{page}{glsnumberformat}{\@alph{2}}
\end{verbatim}
These records are consecutive. The locations match the 
\hyperref[itm.csmatch]{control sequence pattern}. The control
sequences are the same, so the test is retried with the first
location set to 1 and the second location set to 2.
(Note that \cs{glsxtrresourcefile} changes the category code of
\texttt{@} to allow for internal commands in locations.)
\end{enumerate}

\subsection{\csoptnv{loc-gap}=\margm{value}}
\labelopt{loc-gap}

This setting is used to determine whether two locations are
considered consecutive.
The value must be an integer greater than or equal to 1.
(The default is \optfmt{1}.)

For two locations, \meta{location-1} and \meta{location-2},
that have numeric values $n_1$ and $n_2$ (and identical prefix,
counter and format), then the sequence \meta{location-1},
\meta{location-2} is considered consecutive if
\[
0 < n_2 - n_1 \leq \text{\meta{loc-gap}}
\]
The default value of 1 means that \meta{location-2} immediately
follows \meta{location-1} if $n_2 = n_1+1$.

For example, if \meta{location-1} is \qt{B} and \meta{location-2} 
is \qt{C}, then $n_1 = 66$ and $n_2 = 67$. Since $n_2 = 67 = 66+1=
n_1+1$ then \meta{location-2} immediately follows \meta{location-1}.

This is used in the range formations within the location lists.
So, for example, the list \qt{1, 2, 3, 5, 7, 8, 10, 11, 12, 58, 59,
61} becomes
\qt{1--3, 5, 7, 8, 10--12, 58, 59, 61}.

The automatically indexing of commands like \cs{gls} means that
the location lists can become long and ragged. You could
deal with this by switching off the automatic indexing and
only explicitly index pertinent use or you can adjust
the value of \optfmt{loc-gap} so that a range can be formed even
there are one or two gaps in it.

So with the above set of locations, if \csopt[2]{loc-gap} then 
the list becomes \qt{1--12, 58--61} which now highlights that
there are two blocks within the document related to that
term.

\subsection{\csoptnv{suffixF}=\margm{value}}
\labelopt{suffixF}

If set, a range consisting of two consecutive locations 
\meta{loc-1} and \meta{loc-2} will be
displayed in the location list as \meta{loc-1}\meta{value}.

Note that \csopt[{}]{suffixF} sets the suffix to the
empty string. To remove the suffix formation use
\csopt[none]{suffixF}.

The default is \csopt[none]{suffixF}.

\subsection{\csoptnv{suffixFF}=\margm{value}}
\labelopt{suffixFF}

If set, a range consisting of three or more consecutive locations 
\meta{loc-1} and \meta{loc-2} will be
displayed in the location list as \meta{loc-1}\meta{value}.

Note that \csopt[{}]{suffixFF} sets the suffix to the
empty string. To remove the suffix formation use
\csopt[none]{suffixFF}.

The default is \csopt[none]{suffixFF}.

\subsection{\csoptnv{see}=\margm{value}}
\labelopt{see}

If an entry has a \field{see} field, this can be placed before or
after the location list, or completely omitted (but the value will
still be available in the \field{see} field for use with
\cs{glsxtrusesee}). This option may take the following values:
\begin{itemize}
\item \optfmt{omit}: omit the see reference from the location
list.
\item \optfmt{before}: place the see reference before the location
list.
\item \optfmt{after}: place the see reference after the location
list (default).
\end{itemize}
The separator between the location list and the see reference is
provided by \csref{bibglsseesep}. This separator is omitted if the
location list is empty. The \meta{value} part is required.

\subsection{\csoptnv{loc-prefix}=\margm{value}}
\labelopt{loc-prefix}

The \csopt{loc-prefix} setting indicates that the location lists
should begin with \csref{bibglsprefix}\marg{n}. The \meta{value} may
be one of the following:
\begin{itemize}
\item \optfmt{false}: don't insert \cs{bibglsprefix}\marg{n} at the start
of the location lists (default).
\item \optfmt{\margm{prefix-1},\margm{prefix-2},\ldots,\margm{prefix-n}}:
insert \cs{bibglsprefix}\marg{n} (where \meta{n} is the number of
locations in the list) at the start of each location list and the
definition of \cs{bibglsprefix} will be appended to the glossary
preamble providing an \cs{ifcase} condition:
\begin{alltt}
\cs{providecommand}\marg{\cs{bibglsprefix}}[1]\marg{\%
  \cs{ifcase}\string#1
  \csfmt{or} \meta{prefix-1}\csref{bibglspostprefix}
  \csfmt{or} \meta{prefix-2}\csfmt{bibglspostprefix}
  \ldots
  \csfmt{else} \meta{prefix-n}\csfmt{bibglspostprefix}
  \csfmt{fi}
}
\end{alltt}

\item \optfmt{list}: equivalent to \csopt[\cs{pagelistname} ]{loc-prefix}.
\item \optfmt{true}: equivalent to 
\csopt[\meta{page},\meta{pages}]{loc-prefix}, where \meta{page} and
\meta{pages} are obtained from the \texttt{tag.page} and
\texttt{tag.pages} entries in \bibgls's \hyperref[sec:lang.xml]{language file}.
This setting is only appropriate if the document's language matches the 
language file.
\end{itemize}

If \meta{value} is omitted, \optfmt{true} is assumed.

\subsection{\csoptnv{loc-suffix}=\margm{value}}
\labelopt{loc-suffix}

Not yet implemented.

\section{Sorting}
\label{sec:sortingopts}

\subsection{\csoptnv{sort}=\margm{value}}
\labelopt{sort}

The \csopt{sort} key indicates how entries should be sorted. The
\meta{value} may be one of:
\begin{itemize}
\item \texttt{locale}: sort the entries according to the operating
system's locale (default).
\item \texttt{none} (or \texttt{unsrt}): don't sort the entries.
\item \texttt{use}: sort in order of use. (This order is determined
by the records written to the \ext{aux} file by the \styopt{record}
package option.)
\item \texttt{letter-case}: case-sensitive letter sort.
\item \texttt{letter-nocase}: case-insensitive letter sort.
\item \meta{lang tag}: sort according to the rules of the locale
given by the IETF language tag \meta{lang tag}.
\end{itemize}

For example:
\begin{verbatim}
\GlsXtrLoadResources[src={english-terms},sort={en}]
\glsxtrresourcefile[sort={de-1996}]{german-terms}
\end{verbatim}

\subsection{\csoptnv{sort-field}=\margm{label}}
\labelopt{sort-field}

The \csopt{sort-field} key indicates which field provides the sort
value. The default is the \field{sort} field. For example
\begin{verbatim}
\GlsXtrLoadResources[src={entries-terms},sort-label=category,sort=letter-case]
\end{verbatim}
This sorts the entries according to the \field{category} field using
a case-sensitive letter comparison.

\section{Dual Entries}

\subsection{\csoptnv{dual-sort}=\margm{value}}
\labelopt{dual-sort}

This option indicates how to sort the dual entries. The primary
entries are sorted with the normal entries. If
\csopt[combine]{dual-sort} then the dual entries will be
combined with the primary entries and sorted according to the
\optref{sort} option.

If \meta{value} isn't set to \optfmt{combine} then the dual
entries are sorted separately according to \meta{value} (as per
\optref{sort}) and the dual entries will be appended at the end of
the \ext{glstex} file. The field used by the comparator is given by
\optref{dual-sort-field}.

For example:
\begin{verbatim}
\GlsXtrLoadResources[
 src={entries-dual},
 sort={en},
 dual-sort={de-CH-1996}
]
\end{verbatim}
This will sort the primary entries according to \optfmt{en}
(English) and the secondary entries according to \optfmt{de-CH-1996} 
(Swiss German new orthography) whereas:
\begin{verbatim}
\GlsXtrLoadResources[
 src={entries-dual},
 sort={en-GB},
 dual-sort={combine}
]
\end{verbatim}
will combine the dual entries with the primary entries and sort them
all according to the \optfmt{en-GB} locale.

If not set, \csopt{dual-sort} defaults to \optfmt{combine}. If
\meta{value} is omitted, \optfmt{locale} is assumed.

\subsection{\csoptnv{dual-sort-field}=\margm{value}}
\labelopt{dual-sort-field}

This option indicates the field to use when sorting dual entries
(when they haven't been combined with the primary entries). The
default value is the same as the \optref{sort-field} value.

\subsection{\csoptnv{dual-prefix}=\margm{value}}
\labelopt{dual-prefix}

This option indicates the prefix to use for the dual entries. The
default value is \idprefix{dual} (including the terminating period). 
Any references to dual entries within the \ext{bib} file should use
the prefix \idprefix{dual} which will be replaced by \meta{value}
when the \ext{bib} file is parsed.

\subsection{\csoptnv{dual-type}=\margm{value}}
\labelopt{dual-type}

This option sets the \field{type} field for all dual
entries. (The primary entries obey the \optref{type} option.) This
will override any value of \field{type} provided in the \ext{bib}
file (or created through a mapping). The \meta{value} is required.

The \meta{value} may be:
\begin{itemize}
\item \optfmt{same as entry}: sets the
\field{type} to the entry type. For example, if the entry
was defined with \atentryref{dualentry}, the \field{type} will be
set to \optfmt{dualentry}.
\item \optfmt{same as primary}: sets the \field{type} to the same
as the corresponding primary entry's \field{type} (which may
have been set with \optref{type}). If the primary entry doesn't
have the \field{type} field set, the dual's \field{type} will
remain unchanged.
\item \meta{label}: sets the \field{type} field to \meta{label}.
\end{itemize}

Remember that the glossary with that label must have already 
been defined.

For example:
\begin{verbatim}
\newglossary*{english}{English}
\newglossary*{french}{French}

\GlsXtrLoadResources[src={entries},sort={en},dual-sort={fr},
 type=english,
 dual-type=french]
\end{verbatim}

Alternatively:
\begin{verbatim}
\newglossary*{dictionary}{Dictionary}

\GlsXtrLoadResources[src={entries},sort={en},dual-sort={fr},
 type=dictionary,
 dual-type={same as primary}]
\end{verbatim}

\subsection{\csoptnv{dual-category}=\margm{value}}
\labelopt{dual-category}

This option sets the \field{category} field for all dual
entries. (The primary entries obey the \optref{category} option.) This
will override any value of \field{category} provided in the \ext{bib}
file (or created through a mapping). The \meta{value} may be empty.

The \meta{value} may be:
\begin{itemize}
\item \optfmt{same as entry}: sets the
\field{category} to the entry type. For example, if the entry
was defined with \atentryref{dualentry}, the \field{category} will be
set to \optfmt{dualentry}.
\item \optfmt{same as primary}: sets the \field{category} to the same
as the corresponding primary entry's \field{category} (which may
have been set with \optref{category}). If the primary entry doesn't
have the \field{category} field set, the dual's \field{category} will
remain unchanged.
\item \optfmt{same as type}: sets the \field{category} to the same
as the value of the entry's \field{type} field (which may have been
set with \optref{dual-type}). If the entry doesn't
have the \field{type} field set, the \field{category} will
remain unchanged.
\item \meta{label}: sets the \field{category} field to \meta{label}.
\end{itemize}


\subsection{\csoptnv{dual-entry-map}=\marg{\margm{list1},\margm{list2}}}
\labelopt{dual-entry-map}

This setting governs the behaviour of \atentry{dualentry}
definitions. The value consists of two comma-separated lists of
equal length identifying the field mapping used to create the dual
entry from the primary one.

The default setting is:
\begin{verbatim}
dual-entry-map=
{
  {name,plural,description,descriptionplural},
  {description,descriptionplural,name,plural}
}
\end{verbatim}
The dual entry is created by copying the value of the field in the
first list \meta{list1} to the field in the corresponding place in the second
list \meta{list2}. Any additional fields are copied over to the same
field.

For example:
\begin{verbatim}
@dualentry{cat,
  name={cat},
  description={chat},
  see={dog}
}
\end{verbatim}
defines two entries. The primary entry is essentially like
\begin{verbatim}
@entry{cat,
  name={cat},
  plural={cat\glspluralsuffix },
  description={chat},
  descriptionplural={chat\glspluralsuffix },
  see={dog}
}
\end{verbatim}
and the dual entry is essentially like
\begin{verbatim}
@entry{dual.cat,
  description={cat},
  descriptionplural={cat\glspluralsuffix },
  name={chat},
  plural={chat\glspluralsuffix },
  see={dog}
}
\end{verbatim}
(except they're defined using \cs{bibglsnewdualentry} instead of
\cs{bibglsnewentry}, and each is considered dependent on the other.)

The \field{see} field isn't listed in \csopt{dual-entry-map} so its
value is simply copied directly over to the \field{see} field in the
dual entry. Note that the missing plural fields (\field{plural} and
\field{descriptionplural}) have been filled in.

In general \bibgls\ doesn't try to supply missing fields, but in the
dual entry cases it needs to do this for the mapped fields. This is
because the shuffled fields might have different default values from
the \sty{glossaries-extra} package's point of view. For example, 
\cs{longnewglossaryentry} doesn't provide a default for
\field{descriptionplural} if if hasn't been set.

\subsection{\csoptnv{dual-abbrv-map}=\marg{\margm{list1},\margm{list2}}}
\labelopt{dual-abbrv-map}

This is like \csopt{dual-entry-map} but applies to
\atentry{dualabbreviation} rather than \atentry{dualentry}. The
default setting is:
\begin{verbatim}
dual-abbrv-map=
{
  {short,shortplural,long,longplural,symbol,symbolplural,
   description,descriptionplural},
  {symbol,symbolplural,description,descriptionplural,short,shortplural,
   long,longplural}
}
\end{verbatim}

This essentially flips the \field{short} field with the
\field{symbol} field and the \field{long} field with the
\field{description} field.

\subsection{\csoptnv{dual-symbol-map}=\marg{\margm{list1},\margm{list2}}}
\labelopt{dual-symbol-map}

This is like \csopt{dual-entry-map} but applies to
\atentry{dualsymbol} rather than \atentry{dualentry}. The
default setting is:
\begin{verbatim}
dual-symbol-map=
{
  {name,plural,symbol,symbolplural},
  {symbol,symbolplural,name,plural}
}
\end{verbatim}

This essentially flips the \field{name} field with the
\field{symbol} field.

\subsection{\csoptnv{dual-entry-backlink}=\margm{boolean}}
\labelopt{dual-entry-backlink}

This is a boolean setting.
When used with \atentry{dualentry}, if \meta{boolean} is
\optfmt{true}, this will wrap the contents of first mapped field
with \cs{glshyperlink}. If \meta{boolean} is missing \optfmt{true}
is assumed.

The field is obtained from the first mapping
listed in \csopt{dual-entry-map}.

For example, if the document contains:
\begin{verbatim}
\GlsXtrLoadResource[dual-entry-backlink,
dual-entry-map={
  {name,plural,description,descriptionplural},
  {description,descriptionplural,name,plural}
},
src={entries-dual}]
\end{verbatim}
and if the \ext{bib} file contains
\begin{verbatim}
@dualentry{child,
  name={child},
  plural={children},
  description={enfant}
}
\end{verbatim}
Then the definition of the primary entry (\texttt{child}) in the
\ext{glstex} file will have the \field{description} field set to
\begin{verbatim}
{\glshyperlink[enfant]{dual.child}}
\end{verbatim}
and the dual entry (\texttt{dual.child}) will have the
\field{description} field set to
\begin{verbatim}
{\glshyperlink[child]{child}}
\end{verbatim}

The reason the \field{description} field is chosen for the modification is
because the first field listed in the first list in \csopt{dual-entry-map} 
is the \field{name} field which maps to \field{description} (the
first field in the second list). This means that the hyperlink for
the dual entry should be put in the \field{description} field.

For the primary entry, the \field{name} field is looked up in the
second list from the \csopt{dual-entry-map} setting. This is the
third item in this second list, so the third item in the first list
is selected, which also happens to be the \field{description} field,
so the hyperlink for the primary entry is put in the
\field{description} field.

\subsection{\csoptnv{dual-abbrv-backlink}=\margm{value}}
\labelopt{dual-abbrv-backlink}

This is analogous to \csopt{dual-entry-backlink} but for entries
defined with \atentry{dualabbreviation} instead of
\atentry{dualentry}.

\subsection{\csoptnv{dual-symbol-backlink}=\margm{value}}
\labelopt{dual-symbol-backlink}

This is analogous to \csopt{dual-entry-backlink} but for entries
defined with \atentry{dualsymbol} instead of \atentry{dualentry}.

\subsection{\csoptnv{dual-backlink}=\margm{value}}
\labelopt{dual-backlink}

Shortcut for \csopt[\meta{value}]{dual-entry-backlink}, 
\csopt[\meta{value}]{dual-abbrv-backlink}, and
\csopt[\meta{value}]{dual-symbol-backlink}.

\subsection{\csoptnv{dual-field}=\margm{value}}
\labelopt{dual-field}

If this option is used, this will add \cs{glsxtrprovidestoragekey}
to the start of the \ext{glstex} file providing the key given by
\meta{value}.  Any entries defined using \atentry{dualentry}
will be written to the \ext{glstex} file with an extra field called
\meta{value} that is set to the mirror entry. If \meta{value} is
omitted \texttt{dual} is assumed.

For example, if the \ext{bib} file contains
\begin{verbatim}
@dualentry{child,
  name={child},
  plural={children},
  description={enfant}
}
\end{verbatim}
Then with \csopt[dualid]{dual-field} this will first add the line
\begin{verbatim}
\glsxtrprovidestoragekey{dualid}{}{}
\end{verbatim}
at the start of the file and will include the line
\begin{verbatim}
dualid={dual.child},
\end{verbatim}
for the primary entry (\texttt{child}) and the line
\begin{verbatim}
dualid={child},
\end{verbatim}
for the dual entry (\texttt{dual.child}). It's then possible to
reference one entry from the other. For example, the post-description 
hook could contain:
\begin{verbatim}
 \ifglshasfield{dualid}{\glscurrententrylabel}
 {%
   \space
   (\glshyperlink{\glsxtrusefield{\glscurrententrylabel}{dualid}})%
 }%
 {}%
\end{verbatim}
Note that this new field won't be available for use within the
\ext{bib} file (unless it was previously defined in the document
before \cs{glsxtrresourcefile}).

\chapter{Provided Commands}
\label{sec:bibglscs}
\setcounter{secnumdepth}{0}

When \bibgls\ writes the entries to the output file, instead of
directly using commands like \cs{newglossaryentry}, it provides
its own commands defined with \cs{providecommand}. This means that
you can customize the way the entries are defined by providing your
own commands before the \ext{glstex} files are loaded.

\section{\cs{bibglsnewentry}}
\labelcs{bibglsnewentry}

\begin{definition}
\cs{bibglsnewentry}\margm{label}\margm{options}\margm{name}\margm{description}
\end{definition}
This command is used to define terms identified with the
\atentry{entry} type. The definition provided in the \ext{glstex}
file is:
\begin{verbatim}
\providecommand{\bibglsnewentry}[4]{%
 \longnewglossaryentry*{#1}{name={#3},#2}{#4}%
}
\end{verbatim}
This uses the starred form of \cs{longnewglossaryentry} that
doesn't automatically append \cs{nopostdesc} (which interferes with
the post-description hooks provided by category attributes).

\section{\cs{bibglsnewsymbol}}
\labelcs{bibglsnewsymbol}

\begin{definition}
\cs{bibglsnewsymbol}\margm{label}\margm{options}\margm{name}\margm{description}
\end{definition}
This command is used to define terms identified with the
\atentry{symbol} type. The definition provided in the \ext{glstex}
file is:
\begin{verbatim}
\providecommand{\bibglsnewsymbol}[4]{%
 \longnewglossaryentry*{#1}{name={#3},sort={#1},category={symbol},#2}{#4}%
}
\end{verbatim}
Note that this sets the \field{sort} field to the label, but this
may be overridden by the \meta{options} if the \field{sort} field
was supplied or if \bibgls\ has determined the value whilst sorting
the entries.

\section{\cs{bibglsnewnumber}}
\labelcs{bibglsnewnumber}

\section{\cs{bibglsnewindex}}
\labelcs{bibglsnewindex}

\section{\cs{bibglsnewacronym}}
\labelcs{bibglsnewacronym}

\section{\cs{bibglsnewabbreviation}}
\labelcs{bibglsnewabbreviation}

\section{\cs{bibglsnewdualentry}}
\labelcs{bibglsnewdualentry}

\section{\cs{bibglsseesep}}
\labelcs{bibglsseesep}

Any entries that provide a \field{see} field (and that field hasn't
be omitted from the location list with \csopt[omit]{see}) will
have \cs{bibglsseesep} inserted between the \field{see} part and the
location list (unless there are no locations, in which case just
the \field{see} part is displayed without \cs{bibglsseesep}).

This command is provided with:
\begin{verbatim}
\providecommand{\bibglsseesep}{, }
\end{verbatim}
You can define this before you load the \ext{bib} file:
\begin{verbatim}
\newcommand{\bibglsseesep}{; }
\GlsXtrLoadResources[src={entries}]
\end{verbatim}
Or you can redefine it afterwards:
\begin{verbatim}
\GlsXtrLoadResources[src={entries}]
\renewcommand{\bibglsseesep}{; }
\end{verbatim}

\section{\cs{bibglspostprefix}}
\labelcs{bibglspostprefix}

If the \optref{loc-prefix} option is on, \csref{bibglsprefix} will
be inserted at the start of location lists. The command \cs{bibglspostprefix}
is placed after the prefix text. This command is provided with:
\begin{verbatim}
\providecommand{\bibglspostprefix}{\ }
\end{verbatim}
which puts a space between the prefix text and the location list.
You can define this before you load the \ext{bib} file:
\begin{verbatim}
\newcommand{\bibglspostprefix}{: }
\GlsXtrLoadResources[src={entries},loc-prefix]
\end{verbatim}
Or you can redefine it afterwards:
\begin{verbatim}
\GlsXtrLoadResources[src={entries},loc-prefix]
\renewcommand{\bibglspostprefix}{: }
\end{verbatim}

\section{\cs{bibglsprefix}}
\labelcs{bibglsprefix}

If the \optref{loc-prefix} option is on, this command will be
provided. If the glossary type has been provided by \optref{type}
(and \optref{dual-type} if there are any dual entries) then the
definition of \cs{bibglsprefix} will be appended to the glossary
preamble for the given type (or types if there are dual entries).
For example, if the document has
\begin{verbatim}
\GlsXtrLoadResources[type=main,loc-prefix={p.,pp.},src={entries}]
\end{verbatim}
and there are no dual entries, then the following will be added to
the \ext{glstex} file:
\begin{verbatim}
\apptoglossarypreamble[main]{%
 \providecommand{\bibglsprefix}[1]{%
  \ifcase##1
  \or p.\bibglspostprefix
  \else pp.\bibglspostprefix
  \fi
 }
}
\end{verbatim}
However, if the \csopt{type} key is missing, then the following will
be added instead:
\begin{verbatim}
\appto\glossarypreamble{%
 \providecommand{\bibglsprefix}[1]{%
  \ifcase#1
  \or p.\bibglspostprefix
  \else pp.\bibglspostprefix
  \fi
 }
}
\end{verbatim}

\resetsecnumdepth

\printindex
\end{document}
